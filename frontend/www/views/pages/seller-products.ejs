<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <%- include('../partials/head', { 
        title: 'æˆ‘çš„å•†å“ - Zipperoo', 
        description: 'ç®¡ç†æ‚¨çš„å•†å“åº«å­˜å’Œè³‡è¨Š'
    }) %>
    <link rel="stylesheet" href="/css/pages/seller-products.css">
</head>
<body>
    <%- include('../partials/navbar', { user: locals.user }) %>

    <main class="seller-products-main">
        <div class="container">
            <!-- é é¢æ¨™é¡Œ -->
            <div class="page-header">
                <nav class="breadcrumb">
                    <a href="/seller/dashboard">è³£å®¶ä¸­å¿ƒ</a>
                    <span>/</span>
                    <span>æˆ‘çš„å•†å“</span>
                </nav>
                
                <div class="header-content">
                    <h1>æˆ‘çš„å•†å“</h1>
                    <p class="subtitle">ç®¡ç†æ‚¨çš„å•†å“åº«å­˜å’Œè³‡è¨Š</p>
                </div>
            </div>

            <!-- å·¥å…·åˆ— -->
            <div class="toolbar">
                <div class="toolbar-left">
                    <div class="search-box">
                        <input type="text" id="search-input" placeholder="æœå°‹å•†å“åç¨±..." class="form-control">
                        <button type="button" id="search-btn" class="btn btn-outline-secondary">
                            <i class="bi bi-search"></i>
                        </button>
                    </div>
                    <select id="status-filter" class="form-select">
                        <option value="">æ‰€æœ‰ç‹€æ…‹</option>
                        <option value="ON_SHELF">ä¸Šæ¶ä¸­</option>
                        <option value="OFF_SHELF">å·²ä¸‹æ¶</option>
                        <option value="OUT_OF_STOCK">ç¼ºè²¨</option>
                    </select>
                </div>
                <div class="toolbar-right">
                    <button type="button" class="btn btn-primary" onclick="window.location.href='/seller/products/new'">
                        <i class="bi bi-plus"></i> æ–°å¢å•†å“
                    </button>
                </div>
            </div>

            <!-- å•†å“çµ±è¨ˆ -->
            <div class="stats-row">
                <div class="stat-item active" data-filter="" onclick="sellerProducts.filterByStatus('')">
                    <div class="stat-label">ç¸½å•†å“æ•¸</div>
                    <div class="stat-value" id="seller-total-products">0</div>
                </div>
                <div class="stat-item" data-filter="ON_SHELF" onclick="sellerProducts.filterByStatus('ON_SHELF')">
                    <div class="stat-label">ä¸Šæ¶ä¸­</div>
                    <div class="stat-value" id="on-shelf-products">0</div>
                </div>
                <div class="stat-item" data-filter="OFF_SHELF" onclick="sellerProducts.filterByStatus('OFF_SHELF')">
                    <div class="stat-label">å·²ä¸‹æ¶</div>
                    <div class="stat-value" id="off-shelf-products">0</div>
                </div>
                <div class="stat-item" data-filter="OUT_OF_STOCK" onclick="sellerProducts.filterByStatus('OUT_OF_STOCK')">
                    <div class="stat-label">ç¼ºè²¨</div>
                    <div class="stat-value" id="out-of-stock-products">0</div>
                </div>
            </div>

            <!-- å•†å“åˆ—è¡¨ -->
            <div class="products-section">
                <!-- è¼‰å…¥ä¸­ç‹€æ…‹ -->
                <div id="products-loading" class="loading-container">
                    <div class="loading-spinner"></div>
                    <p>è¼‰å…¥å•†å“ä¸­...</p>
                </div>

                <!-- å•†å“è¡¨æ ¼ -->
                <div id="products-table" class="table-container" style="display: none;">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>å•†å“</th>
                                <th>åƒ¹æ ¼ç¯„åœ</th>
                                <th>åº«å­˜</th>
                                <th>ç‹€æ…‹</th>
                                <th>è©•åˆ†</th>
                                <th>éŠ·é‡</th>
                                <th>å»ºç«‹æ™‚é–“</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="products-tbody">
                        </tbody>
                    </table>
                </div>

                <!-- ç©ºç‹€æ…‹ -->
                <div id="products-empty" class="empty-state" style="display: none;">
                    <div class="empty-icon">ğŸ“¦</div>
                    <h3>æš«ç„¡å•†å“</h3>
                    <p>é–‹å§‹æ–°å¢æ‚¨çš„ç¬¬ä¸€å€‹å•†å“å§ï¼</p>
                    <button type="button" class="btn btn-primary" onclick="window.location.href='/seller/products/new'">
                        æ–°å¢å•†å“
                    </button>
                </div>

                <!-- éŒ¯èª¤ç‹€æ…‹ -->
                <div id="products-error" class="error-state" style="display: none;">
                    <div class="error-icon">âŒ</div>
                    <h3>è¼‰å…¥å¤±æ•—</h3>
                    <p>ç„¡æ³•è¼‰å…¥å•†å“åˆ—è¡¨ï¼Œè«‹ç¨å¾Œå†è©¦</p>
                    <button type="button" class="btn btn-outline-primary" onclick="sellerProducts.loadProducts()">
                        é‡æ–°è¼‰å…¥
                    </button>
                </div>
            </div>

            <!-- åˆ†é  -->
            <div id="pagination" class="pagination-container" style="display: none;">
                <nav>
                    <ul class="pagination justify-content-center">
                        <li class="page-item" id="prev-page">
                            <a class="page-link" href="#" onclick="sellerProducts.previousPage()">ä¸Šä¸€é </a>
                        </li>
                        <li class="page-item active">
                            <span class="page-link" id="current-page">1</span>
                        </li>
                        <li class="page-item" id="next-page">
                            <a class="page-link" href="#" onclick="sellerProducts.nextPage()">ä¸‹ä¸€é </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </main>

    <!-- å•†å“ç·¨è¼¯æ¨¡æ…‹æ¡† -->
    <div class="modal fade" id="productEditModal" tabindex="-1" aria-labelledby="productEditModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="background-color: #fefcf9; border: 1px solid #e8dcc6;">
                <div class="modal-header" style="background-color: #f8f2e8; border-bottom: 1px solid #e8dcc6;">
                    <h5 class="modal-title" id="productEditModalLabel" style="color: #8b4513;">ç·¨è¼¯å•†å“</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="é—œé–‰"></button>
                </div>
                <div class="modal-body" id="productEditModalContent">
                    <!-- å‹•æ…‹è¼‰å…¥å•†å“ç·¨è¼¯è¡¨å–® -->
                </div>
                <div class="modal-footer" style="background-color: #faf6f0; border-top: 1px solid #e8dcc6;">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="background-color: #9e8a78; border-color: #9e8a78; color: white;">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-primary" id="saveProductBtn" style="background-color: #a67c52; border-color: #a67c52; color: white;">å„²å­˜è®Šæ›´</button>
                </div>
            </div>
        </div>
    </div>

    <%- include('../partials/footer') %>

    <%- include('../partials/scripts') %>
    <script>
        // ç­‰å¾… App åˆå§‹åŒ–å®Œæˆå¾Œå†è¼‰å…¥ seller-products
        window.addEventListener('appInitialized', function() {
            const script = document.createElement('script');
            script.src = '/js/pages/seller-products.js';
            document.head.appendChild(script);
        });
        
        // å¦‚æœ App å·²ç¶“åˆå§‹åŒ–ï¼Œç›´æ¥è¼‰å…¥
        if (window.App && window.App.initialized) {
            const script = document.createElement('script');
            script.src = '/js/pages/seller-products.js';
            document.head.appendChild(script);
        }
    </script>
</body>
</html> 