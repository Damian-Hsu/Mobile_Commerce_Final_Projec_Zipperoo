<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <%- include('../partials/head', { 
        title: 'æˆ‘çš„è¨‚å–® - Zipperoo', 
        description: 'ç®¡ç†æ‚¨çš„è¨‚å–®å’Œå‡ºè²¨ç‹€æ…‹'
    }) %>
    <link rel="stylesheet" href="/css/pages/seller-orders.css">
</head>
<body>
    <%- include('../partials/navbar', { user: locals.user }) %>

    <main class="seller-orders-main">
        <div class="container">
            <!-- é é¢æ¨™é¡Œ -->
            <div class="page-header">
                <nav class="breadcrumb">
                    <a href="/seller/dashboard">è³£å®¶ä¸­å¿ƒ</a>
                    <span>æˆ‘çš„è¨‚å–®</span>
                </nav>
                <div class="header-content">
                    <h1>æˆ‘çš„è¨‚å–®</h1>
                    <p class="subtitle">ç®¡ç†æ‚¨çš„è¨‚å–®å’Œå‡ºè²¨ç‹€æ…‹</p>
                </div>
            </div>

            <!-- å·¥å…·åˆ— -->
            <div class="toolbar">
                <div class="toolbar-left">
                    <div class="search-box">
                        <input type="text" id="search-input" placeholder="æœå°‹è¨‚å–®ç·¨è™Ÿæˆ–å®¢æˆ¶..." class="form-control">
                        <button type="button" id="search-btn" class="btn btn-outline-secondary">
                            <i class="bi bi-search"></i>
                        </button>
                    </div>
                    <select id="status-filter" class="form-select">
                        <option value="">æ‰€æœ‰ç‹€æ…‹</option>
                        <option value="UNCOMPLETED">å¾…è™•ç†</option>
                        <option value="SHIPPED">å·²å‡ºè²¨</option>
                        <option value="COMPLETED">å·²å®Œæˆ</option>
                        <option value="CANCELED">å·²å–æ¶ˆ</option>
                    </select>
                    <select id="date-filter" class="form-select">
                        <option value="">æ‰€æœ‰æ™‚é–“</option>
                        <option value="today">ä»Šå¤©</option>
                        <option value="week">æœ¬é€±</option>
                        <option value="month">æœ¬æœˆ</option>
                        <option value="quarter">æœ¬å­£</option>
                    </select>
                </div>
                <div class="toolbar-right">
                    <button type="button" class="btn btn-outline-primary" onclick="sellerOrders.exportOrders()">
                        <i class="bi bi-file-earmark-bar-graph"></i>åŒ¯å‡ºå ±è¡¨
                    </button>
                </div>
            </div>

            <!-- è¨‚å–®çµ±è¨ˆ -->
            <div class="stats-row">
                <div class="stat-item active" data-filter="" onclick="sellerOrders.filterByStatus('')">
                    <div class="stat-label">ç¸½è¨‚å–®æ•¸</div>
                    <div class="stat-value" id="seller-total-orders">0</div>
                </div>
                <div class="stat-item" data-filter="UNCOMPLETED" onclick="sellerOrders.filterByStatus('UNCOMPLETED')">
                    <div class="stat-label">å¾…è™•ç†</div>
                    <div class="stat-value" id="uncompleted-orders">0</div>
                </div>
                <div class="stat-item" data-filter="SHIPPED" onclick="sellerOrders.filterByStatus('SHIPPED')">
                    <div class="stat-label">å·²å‡ºè²¨</div>
                    <div class="stat-value" id="shipped-orders">0</div>
                </div>
                <div class="stat-item" data-filter="COMPLETED" onclick="sellerOrders.filterByStatus('COMPLETED')">
                    <div class="stat-label">å·²å®Œæˆ</div>
                    <div class="stat-value" id="completed-orders">0</div>
                </div>
                <div class="stat-item" data-filter="revenue" onclick="sellerOrders.filterByStatus('')">
                    <div class="stat-label">ç¸½æ”¶å…¥</div>
                    <div class="stat-value" id="total-revenue">NT$ 0</div>
                </div>
            </div>

            <!-- è¨‚å–®åˆ—è¡¨ -->
            <div class="orders-section">
                <!-- è¼‰å…¥ä¸­ç‹€æ…‹ -->
                <div id="orders-loading" class="loading-container">
                    <div class="loading-spinner"></div>
                    <p>è¼‰å…¥è¨‚å–®ä¸­...</p>
                </div>

                <!-- è¨‚å–®è¡¨æ ¼ -->
                <div id="orders-table" class="table-container" style="display: none;">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>è¨‚å–®ç·¨è™Ÿ</th>
                                <th>å®¢æˆ¶</th>
                                <th>å•†å“</th>
                                <th>é‡‘é¡</th>
                                <th>ç‹€æ…‹</th>
                                <th>ä¸‹å–®æ™‚é–“</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="orders-tbody">
                        </tbody>
                    </table>
                </div>

                <!-- ç©ºç‹€æ…‹ -->
                <div id="orders-empty" class="empty-state" style="display: none;">
                    <div class="empty-icon">ğŸ“‹</div>
                    <h3>æš«ç„¡è¨‚å–®</h3>
                    <p>é‚„æ²’æœ‰å®¢æˆ¶ä¸‹å–®ï¼Œç¹¼çºŒæ¨å»£æ‚¨çš„å•†å“å§ï¼</p>
                </div>

                <!-- éŒ¯èª¤ç‹€æ…‹ -->
                <div id="orders-error" class="error-state" style="display: none;">
                    <div class="error-icon">âŒ</div>
                    <h3>è¼‰å…¥å¤±æ•—</h3>
                    <p>ç„¡æ³•è¼‰å…¥è¨‚å–®åˆ—è¡¨ï¼Œè«‹ç¨å¾Œå†è©¦</p>
                    <button type="button" class="btn btn-outline-primary" onclick="sellerOrders.loadOrders()">
                        é‡æ–°è¼‰å…¥
                    </button>
                </div>
            </div>

            <!-- åˆ†é  -->
            <div id="pagination" class="pagination-container" style="display: none;">
                <nav>
                    <ul class="pagination justify-content-center">
                        <li class="page-item" id="prev-page">
                            <a class="page-link" href="#" onclick="sellerOrders.previousPage()">ä¸Šä¸€é </a>
                        </li>
                        <li class="page-item active">
                            <span class="page-link" id="current-page">1</span>
                        </li>
                        <li class="page-item" id="next-page">
                            <a class="page-link" href="#" onclick="sellerOrders.nextPage()">ä¸‹ä¸€é </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </main>

    <%- include('../partials/footer') %>

    <!-- è¨‚å–®è©³æƒ…æ¨¡æ…‹æ¡† -->
    <div class="modal fade" id="orderDetailModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">è¨‚å–®è©³æƒ…</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="orderDetailContent">
                    <!-- è¨‚å–®è©³æƒ…å…§å®¹å°‡åœ¨é€™è£¡å‹•æ…‹è¼‰å…¥ -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">é—œé–‰</button>
                </div>
            </div>
        </div>
    </div>

    <%- include('../partials/scripts') %>
    <script>
        // ç­‰å¾… App åˆå§‹åŒ–å®Œæˆå¾Œå†è¼‰å…¥ seller-orders
        window.addEventListener('appInitialized', function() {
            const script = document.createElement('script');
            script.src = '/js/pages/seller-orders.js';
            document.head.appendChild(script);
        });
        
        // å¦‚æœ App å·²ç¶“åˆå§‹åŒ–ï¼Œç›´æ¥è¼‰å…¥
        if (window.App && window.App.initialized) {
            const script = document.createElement('script');
            script.src = '/js/pages/seller-orders.js';
            document.head.appendChild(script);
        }
    </script>
</body>
</html> 