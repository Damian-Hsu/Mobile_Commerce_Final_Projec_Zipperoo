# Zipperoo è³¼è¡£å¹³å°ç³»çµ±ä»‹ç´¹

Zipperoo æ˜¯ä¸€å€‹åŠŸèƒ½å®Œæ•´çš„é›»å•†å¹³å°å¾Œç«¯ç³»çµ±ï¼Œæ¡ç”¨ç¾ä»£åŒ–çš„ NestJS + PostgreSQL + Prisma æŠ€è¡“æ£§ï¼Œæ”¯æ´è²·å®¶ã€è³£å®¶ã€ç®¡ç†å“¡ä¸‰ç¨®è§’è‰²çš„é›»å•†ç”Ÿæ…‹ç³»çµ±ï¼Œå…·å‚™å•†å“è®Šé«”ç®¡ç†ã€å³æ™‚èŠå¤©ã€è©•åƒ¹ç³»çµ±ç­‰ä¼æ¥­ç´šåŠŸèƒ½ã€‚

## ğŸŒŸ è¨­è¨ˆé¡˜æ™¯

å»ºç«‹ä¸€å€‹ç©©å®šã€å¯æ“´å±•çš„é›»å•†å¹³å°ï¼Œç‚ºä¸åŒè§’è‰²æä¾›æœ€ä½³çš„ä½¿ç”¨é«”é©—ï¼š
- **ğŸ’° è³£å®¶** - è¼•é¬†ç®¡ç†å•†å“ã€è™•ç†è¨‚å–®ã€èˆ‡å®¢æˆ¶æºé€š
- **ğŸ›’ è²·å®¶** - æµæš¢çš„è³¼ç‰©é«”é©—ã€å®‰å…¨çš„æ”¯ä»˜æµç¨‹ã€å³æ™‚å®¢æœ
- **ğŸ”§ ç®¡ç†å“¡** - å…¨é¢çš„ç³»çµ±ç›£æ§ã€ç”¨æˆ¶ç®¡ç†ã€æ•¸æ“šåˆ†æ

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½ç‰¹è‰²

### ğŸ‘¥ å¤šè§’è‰²æ¬Šé™ç³»çµ±
- **Buyerï¼ˆè²·å®¶ï¼‰**: å•†å“ç€è¦½ã€æœå°‹ç¯©é¸ã€è³¼ç‰©è»Šç®¡ç†ã€è¨‚å–®è¿½è¹¤ã€å•†å“è©•åƒ¹ã€å³æ™‚èŠå¤©
- **Sellerï¼ˆè³£å®¶ï¼‰**: å•†å“èˆ‡è®Šé«”ç®¡ç†ã€è¨‚å–®è™•ç†ã€å®¢æœèŠå¤©ã€éŠ·å”®æ•¸æ“šã€åœ–ç‰‡ä¸Šå‚³
- **Adminï¼ˆç®¡ç†å“¡ï¼‰**: ç”¨æˆ¶ç®¡ç†ã€å•†å“å¯©æ ¸ã€ç³»çµ±ç›£æ§ã€æ—¥èªŒè¿½è¹¤ã€æ¬Šé™æ§åˆ¶

### ğŸ›ï¸ é€²éšå•†å“ç³»çµ±
- **å•†å“è®Šé«”ç®¡ç†**: æ”¯æ´é¡è‰²ã€å°ºå¯¸ç­‰å¤šå±¬æ€§çµ„åˆ
- **æ™ºèƒ½åˆ†é¡ç³»çµ±**: å±¤ç´šå¼å•†å“åˆ†é¡ç®¡ç†
- **åœ–ç‰‡ç®¡ç†**: å¤šåœ–ç‰‡ä¸Šå‚³ã€å£“ç¸®ã€CDN åˆ†ç™¼
- **åº«å­˜æ§åˆ¶**: å¯¦æ™‚åº«å­˜åŒæ­¥ã€è¶…è³£é˜²è­·
- **æœå°‹èˆ‡ç¯©é¸**: å…¨æ–‡æœå°‹ã€åƒ¹æ ¼å€é–“ã€åˆ†é¡ç¯©é¸

### ğŸ’³ å®Œæ•´äº¤æ˜“æµç¨‹
- **æ™ºèƒ½è³¼ç‰©è»Š**: å•†å“é¸æ“‡ã€æ•¸é‡èª¿æ•´ã€åƒ¹æ ¼è¨ˆç®—
- **å®‰å…¨çµå¸³**: åº«å­˜é–å®šã€äº‹å‹™è™•ç†ã€ç‹€æ…‹ç®¡ç†
- **è¨‚å–®è¿½è¹¤**: å®Œæ•´çš„è¨‚å–®ç”Ÿå‘½é€±æœŸç®¡ç†
- **è©•åƒ¹ç³»çµ±**: å•†å“è©•åˆ†ã€è©•è«–ç®¡ç†ã€ä¿¡è­½å»ºç«‹

### ğŸ’¬ å³æ™‚é€šè¨Šç³»çµ±
- **WebSocket èŠå¤©**: è²·è³£å®¶å³æ™‚æºé€š
- **èŠå¤©å®¤ç®¡ç†**: è‡ªå‹•å»ºç«‹ã€è¨Šæ¯æ­·å²ã€ç‹€æ…‹åŒæ­¥
- **å®¢æœæ”¯æ´**: å¤šå°è©±ç®¡ç†ã€è¨Šæ¯æ¨é€

### ğŸ” ä¼æ¥­ç´šå®‰å…¨
- **JWT èªè­‰**: ç„¡ç‹€æ…‹èªè­‰ã€Token åˆ·æ–°
- **è§’è‰²æ¬Šé™**: ç´°ç²’åº¦æ¬Šé™æ§åˆ¶ã€API ä¿è­·
- **å¯†ç¢¼å®‰å…¨**: bcrypt åŠ å¯†ã€é‡è¨­æµç¨‹
- **æ•¸æ“šé©—è­‰**: DTO é©—è­‰ã€é¡å‹å®‰å…¨

## ğŸ›ï¸ ç³»çµ±åˆ†æèˆ‡è¨­è¨ˆ

æœ¬ç¯€è©³ç´°é—¡è¿°äº† Zipperoo ç³»çµ±çš„æ ¸å¿ƒè¨­è¨ˆï¼ŒåŒ…å«ç³»çµ±çš„åƒèˆ‡è€…ã€åŠŸèƒ½ã€ä»¥åŠæ ¸å¿ƒæ¥­å‹™å°è±¡çš„çµæ§‹èˆ‡é—œä¿‚ã€‚  
è©³ç´°å…§å®¹å¯ä»¥åœ¨ `/SystemDesign` æŸ¥çœ‹ï¼Œå…§å«æœ‰æ‰€æœ‰è¨­è¨ˆåœ–ä»¥åŠAPIè¨­è¨ˆè¡¨æ ¼ï¼ŒåŒæ™‚é‚„æœ‰è©³ç´°çš„APIä»‹é¢ä»‹ç´¹ã€‚
### UML ç”¨ä¾‹åœ– (Use Case Diagram)
ç”¨ä¾‹åœ–æè¿°äº†ç³»çµ±å¤–éƒ¨ä¸åŒè§’è‰²ï¼ˆActorsï¼‰èˆ‡ç³»çµ±æä¾›çš„åŠŸèƒ½ï¼ˆUse Casesï¼‰ä¹‹é–“çš„äº’å‹•é—œä¿‚ï¼Œ**å®Œå…¨åŸºæ–¼å¯¦éš› API ç«¯é»å’Œæ§åˆ¶å™¨å¯¦ç¾**ï¼Œå±•ç¤ºäº†ç³»çµ±çš„çœŸå¯¦æ¥­å‹™æµç¨‹ã€‚

```mermaid
graph LR
    subgraph "Zipperoo é›»å•†å¹³å°ç³»çµ±"
        subgraph "ç³»çµ±æª¢æŸ¥ (System)"
            UC1(ç³»çµ±å¥åº·æª¢æŸ¥)
        end
        
        subgraph "å¸³è™Ÿèªè­‰ (Authentication)"
            UC2(è¨»å†Šå¸³è™Ÿ)
            UC3(ç™»å…¥)
            UC4(ç™»å‡º)
            UC5(æŸ¥çœ‹å€‹äººè³‡æ–™)
            UC6(æ›´æ–°å€‹äººè³‡æ–™)
            UC7(å¿˜è¨˜å¯†ç¢¼)
            UC8(é‡è¨­å¯†ç¢¼)
        end
        
        subgraph "å…¬é–‹åŠŸèƒ½ (Public API)"
            UC9(ç€è¦½å•†å“åˆ—è¡¨)
            UC10(æŸ¥çœ‹å•†å“è©³æƒ…)
            UC11(ç€è¦½åˆ†é¡)
            UC12(æŸ¥çœ‹å•†å“è©•åƒ¹åˆ—è¡¨)
            UC13(æŸ¥çœ‹åˆ†é¡ä¸‹çš„å•†å“)
        end
        
        subgraph "åˆ†é¡ç®¡ç† (Category Management)"
            UC14(å»ºç«‹æ–°åˆ†é¡)
            UC15(æŸ¥çœ‹å–®ä¸€åˆ†é¡)
            UC16(æ›´æ–°åˆ†é¡)
            UC17(åˆªé™¤åˆ†é¡)
        end
        
        subgraph "è²·å®¶åŠŸèƒ½ (Buyer API)"
            UC18(æŸ¥çœ‹è³¼ç‰©è»Š)
            UC19(åŠ å…¥è³¼ç‰©è»Š)
            UC20(æ›´æ–°è³¼ç‰©è»Šå•†å“)
            UC21(ç§»é™¤è³¼ç‰©è»Šå•†å“)
            UC22(çµå¸³)
            UC23(æŸ¥çœ‹æˆ‘çš„è¨‚å–®)
            UC24(æŸ¥çœ‹è¨‚å–®è©³æƒ…)
            UC25(å–æ¶ˆè¨‚å–®)
            UC26(ç¢ºèªæ”¶è²¨)
        end
        
        subgraph "è³£å®¶åŠŸèƒ½ (Seller API)"
            UC27(æŸ¥çœ‹è³£å®¶å„€è¡¨æ¿)
            UC28(æŸ¥çœ‹å•†å“çµ±è¨ˆ)
            UC29(æŸ¥çœ‹æˆ‘çš„å•†å“)
            UC30(ä¸Šæ¶æ–°å•†å“)
            UC31(æ›´æ–°å•†å“åŸºæœ¬è³‡è¨Š)
            UC32(ä¸‹æ¶/åˆªé™¤å•†å“)
            UC33(æŸ¥çœ‹æ”¶åˆ°çš„è¨‚å–®)
            UC34(æ¨™è¨˜è¨‚å–®ç‚ºå·²å‡ºè²¨)
            UC35(æ¨™è¨˜è¨‚å–®ç‚ºå·²å®Œæˆ)
        end
        
        subgraph "å•†å“æ¬¾å¼ç®¡ç† (Variant Management)"
            UC36(ç‚ºå•†å“æ–°å¢æ¬¾å¼)
            UC37(æ›´æ–°å•†å“æ¬¾å¼)
            UC38(åˆªé™¤å•†å“æ¬¾å¼)
        end
        
        subgraph "è©•åƒ¹ç³»çµ± (Review API)"
            UC39(å‰µå»ºå•†å“è©•åƒ¹)
            UC40(æ›´æ–°è©•åƒ¹)
            UC41(åˆªé™¤è©•åƒ¹)
        end
        
        subgraph "èŠå¤©ç³»çµ± (Chat API)"
            UC42(å‰µå»ºæˆ–ç²å–èŠå¤©å®¤)
            UC43(ç²å–èŠå¤©å®¤åˆ—è¡¨)
            UC44(æŸ¥çœ‹èŠå¤©è¨Šæ¯)
            UC45(ç™¼é€è¨Šæ¯)
            UC46(æ¨™è¨˜è¨Šæ¯ç‚ºå·²è®€)
            UC47(ç²å–æœªè®€è¨Šæ¯æ•¸é‡)
        end
        
        subgraph "åœ–ç‰‡ç®¡ç† (Image API)"
            UC48(ä¸Šå‚³å•†å“åœ–ç‰‡)
            UC49(åˆªé™¤å•†å“åœ–ç‰‡)
            UC50(é€šéæª”åç²å–åœ–ç‰‡)
            UC51(é€šéIDç²å–åœ–ç‰‡)
        end
        
        subgraph "é€šçŸ¥ç³»çµ± (Notification)"
            UC52(ç²å–é€šçŸ¥è¨ˆæ•¸)
            UC53(æ¥æ”¶å³æ™‚é€šçŸ¥)
        end
        
        subgraph "ç®¡ç†å“¡åŠŸèƒ½ (Admin API)"
            UC54(æŸ¥çœ‹ç®¡ç†å“¡å„€è¡¨æ¿)
            UC55(ç²å–æ‰€æœ‰ç”¨æˆ¶)
            UC56(åˆªé™¤ç”¨æˆ¶)
            UC57(å°é–ç”¨æˆ¶)
            UC58(è§£é™¤å°é–ç”¨æˆ¶)
            UC59(ç²å–æ‰€æœ‰å•†å“)
            UC60(åˆªé™¤ä»»æ„å•†å“)
            UC61(ç²å–æ‰€æœ‰è¨‚å–®)
            UC62(ç²å–è¨‚å–®è©³æƒ…)
            UC63(æ›´æ–°è¨‚å–®ç‹€æ…‹)
            UC64(æŸ¥çœ‹ç³»çµ±æ—¥èªŒ)
            UC65(ç®¡ç†å•†å“åˆ†é¡)
        end
        
        subgraph "çµ±è¨ˆèˆ‡å ±è¡¨ (Analytics)"
            UC66(æŸ¥çœ‹éŠ·å”®å ±è¡¨)
            UC67(æŸ¥çœ‹ç”¨æˆ¶çµ±è¨ˆ)
            UC68(åŒ¯å‡ºè³‡æ–™)
        end
    end
    
    Visitor(ğŸ‘¤ è¨ªå®¢)
    Buyer(ğŸ›’ è²·å®¶<br/>BUYER)
    Seller(ğŸª è³£å®¶<br/>SELLER)
    Admin(ğŸ”§ ç®¡ç†å“¡<br/>ADMIN)

    %% è¨ªå®¢åŠŸèƒ½
    Visitor --> UC1
    Visitor --> UC2
    Visitor --> UC3
    Visitor --> UC7
    Visitor --> UC8
    Visitor --> UC9
    Visitor --> UC10
    Visitor --> UC11
    Visitor --> UC12
    Visitor --> UC13
    Visitor --> UC50
    Visitor --> UC51
    
    %% è²·å®¶åŠŸèƒ½
    Buyer --> UC4
    Buyer --> UC5
    Buyer --> UC6
    Buyer --> UC18
    Buyer --> UC19
    Buyer --> UC20
    Buyer --> UC21
    Buyer --> UC22
    Buyer --> UC23
    Buyer --> UC24
    Buyer --> UC25
    Buyer --> UC26
    Buyer --> UC39
    Buyer --> UC40
    Buyer --> UC41
    Buyer --> UC42
    Buyer --> UC43
    Buyer --> UC44
    Buyer --> UC45
    Buyer --> UC46
    Buyer --> UC47
    Buyer --> UC52
    Buyer --> UC53
    
    %% è³£å®¶åŠŸèƒ½
    Seller --> UC4
    Seller --> UC5
    Seller --> UC6
    Seller --> UC27
    Seller --> UC28
    Seller --> UC29
    Seller --> UC30
    Seller --> UC31
    Seller --> UC32
    Seller --> UC33
    Seller --> UC34
    Seller --> UC35
    Seller --> UC36
    Seller --> UC37
    Seller --> UC38
    Seller --> UC48
    Seller --> UC49
    Seller --> UC14
    Seller --> UC15
    Seller --> UC16
    Seller --> UC17
    Seller --> UC42
    Seller --> UC43
    Seller --> UC44
    Seller --> UC45
    Seller --> UC46
    Seller --> UC47
    Seller --> UC52
    Seller --> UC53
    Seller --> UC66
    
    %% ç®¡ç†å“¡åŠŸèƒ½
    Admin --> UC4
    Admin --> UC5
    Admin --> UC6
    Admin --> UC54
    Admin --> UC55
    Admin --> UC56
    Admin --> UC57
    Admin --> UC58
    Admin --> UC59
    Admin --> UC60
    Admin --> UC61
    Admin --> UC62
    Admin --> UC63
    Admin --> UC64
    Admin --> UC65
    Admin --> UC14
    Admin --> UC15
    Admin --> UC16
    Admin --> UC17
    Admin --> UC36
    Admin --> UC37
    Admin --> UC38
    Admin --> UC39
    Admin --> UC40
    Admin --> UC41
    Admin --> UC42
    Admin --> UC43
    Admin --> UC44
    Admin --> UC45
    Admin --> UC46
    Admin --> UC47
    Admin --> UC48
    Admin --> UC49
    Admin --> UC52
    Admin --> UC53
    Admin --> UC66
    Admin --> UC67
    Admin --> UC68
    
    %% ç¹¼æ‰¿é—œä¿‚
    Buyer -.-> Visitor
    Seller -.-> Visitor
    Admin -.-> Visitor
```

### UML é¡åˆ¥åœ– (Class Diagram)
é¡åˆ¥åœ–å±•ç¤ºäº†ç³»çµ±ä¸­æ ¸å¿ƒçš„æ¥­å‹™å¯¦é«”ã€å®ƒå€‘çš„å±¬æ€§ã€æ–¹æ³•ä»¥åŠå½¼æ­¤ä¹‹é–“çš„éœæ…‹é—œä¿‚ï¼Œ**å®Œå…¨åŸºæ–¼ Prisma Schema çš„çœŸå¯¦è³‡æ–™æ¨¡å‹**ã€‚

```mermaid
classDiagram
    direction TB
    
    %% è§’è‰²å’Œç‹€æ…‹æšèˆ‰
    class Role {
        <<enumeration>>
        BUYER
        SELLER
        ADMIN
    }
    
    class ProductStatus {
        <<enumeration>>
        ON_SHELF
        OFF_SHELF
        DELETED
    }
    
    class OrderStatus {
        <<enumeration>>
        UNCOMPLETED
        COMPLETED
        CANCELED
    }
    
    class PaymentMethod {
        <<enumeration>>
        COD
        CREDIT_CARD
        BANK_TRANSFER
        LINE_PAY
    }
    
    %% æ ¸å¿ƒè³‡æ–™æ¨¡å‹
    class User {
        +Int id
        +String account
        -String passwordHash
        +String username
        +String email
        +String phone
        +Role role
        +Boolean isBlocked
        +String shopName
        +String description
        +DateTime createdAt
        +DateTime updatedAt
        +isSeller() boolean
        +isBuyer() boolean
        +isAdmin() boolean
        +canAccess(resource) boolean
    }

    class Category {
        +Int id
        +String name
        +DateTime createdAt
        +DateTime updatedAt
        +hasProducts() boolean
    }

    class Product {
        +Int id
        +Int sellerId
        +Int categoryId
        +String name
        +String description
        +ProductStatus status
        +DateTime createdAt
        +DateTime updatedAt
        +changeStatus(newStatus) void
        +isOwnedBy(sellerId) boolean
        +isOnShelf() boolean
        +getTotalStock() number
        +getAverageRating() number
    }

    class ProductVariant {
        +Int id
        +Int productId
        +String name
        +Int price
        +Int stock
        +Json attributes
        +DateTime createdAt
        +DateTime updatedAt
        +updateStock(delta) void
        +isAvailable() boolean
        +hasEnoughStock(quantity) boolean
        +getFormattedPrice() string
    }
    
    class ProductImage {
        +Int id
        +Int productId
        +String url
        +DateTime createdAt
        +DateTime updatedAt
        +getFullUrl() string
        +isValid() boolean
    }

    class Cart {
        +Int id
        +Int buyerId
        +DateTime createdAt
        +DateTime updatedAt
        +calculateTotal() Int
        +getSelectedItems() CartItem[]
        +clear() void
        +isEmpty() boolean
        +getItemCount() number
    }

    class CartItem {
        +Int id
        +Int cartId
        +Int productVariantId
        +Int quantity
        +Int unitPrice
        +Boolean isSelected
        +DateTime createdAt
        +DateTime updatedAt
        +getTotal() Int
        +updateQuantity(newQty) void
        +select() void
        +unselect() void
        +isValidQuantity() boolean
    }

    class Order {
        +Int id
        +Int buyerId
        +Int sellerId
        +Int totalAmount
        +OrderStatus status
        +String recipientName
        +String recipientPhone
        +String city
        +String district
        +String postalCode
        +String address
        +String notes
        +PaymentMethod paymentMethod
        +DateTime createdAt
        +DateTime updatedAt
        +canCancel() boolean
        +canShip() boolean
        +canComplete() boolean
        +cancel() void
        +ship() void
        +complete() void
        +getFormattedAmount() string
        +getFullAddress() string
    }
    
    class OrderItem {
        +Int id
        +Int orderId
        +Int productVariantId
        +Int quantity
        +Int unitPrice
        +DateTime createdAt
        +DateTime updatedAt
        +getTotal() Int
        +getFormattedPrice() string
    }

    class Review {
        +Int id
        +Int productId
        +Int orderId
        +Int buyerId
        +Int score
        +String comment
        +Boolean isEdited
        +Boolean isDeleted
        +DateTime createdAt
        +DateTime updatedAt
        +edit(newScore, newComment) void
        +delete() void
        +isOwnedBy(buyerId) boolean
        +isValidScore() boolean
        +getDisplayComment() string
    }

    class ChatRoom {
        +Int id
        +Int buyerId
        +Int sellerId
        +DateTime createdAt
        +DateTime updatedAt
        +canAccess(userId) boolean
        +getOtherParticipant(userId) Int
        +hasUnreadMessages(userId) boolean
    }

    class ChatMessage {
        +Int id
        +Int roomId
        +Int fromUserId
        +String content
        +Boolean isEdited
        +Boolean isReadByBuyer
        +Boolean isReadBySeller
        +DateTime readByBuyerAt
        +DateTime readBySellerAt
        +DateTime createdAt
        +DateTime updatedAt
        +edit(newContent) void
        +markAsRead(userId) void
        +isReadBy(userId) boolean
        +canEdit(userId) boolean
    }

    class LogEntry {
        +Int id
        +String event
        +Int actorId
        +String description
        +String ipAddress
        +Json meta
        +DateTime createdAt
        +getFormattedDate() string
        +hasActor() boolean
    }

    class PasswordResetToken {
        +Int id
        +String email
        +String token
        +DateTime expiresAt
        +DateTime createdAt
        +isExpired() boolean
        +isValid() boolean
    }

    %% é—œè¯é—œä¿‚
    User ||--o{ Product
    User ||--|| Cart
    User ||--o{ Order
    User ||--o{ Review
    User ||--o{ ChatMessage
    User ||--o{ ChatRoom
    User ||--o{ LogEntry
    
    Category ||--o{ Product
    
    Product ||--o{ ProductVariant
    Product ||--o{ ProductImage
    Product ||--o{ Review
    
    ProductVariant ||--o{ CartItem
    ProductVariant ||--o{ OrderItem
    
    Cart ||--o{ CartItem
    
    Order ||--o{ OrderItem
    Order ||--o{ Review
    
    ChatRoom ||--o{ ChatMessage
```

### ğŸ—ï¸ å‰å¾Œç«¯æ¶æ§‹åœ– (Frontend-Backend Architecture)
æœ¬æ¶æ§‹åœ–å±•ç¤ºäº†å‰ç«¯å®¢æˆ¶ç«¯é¡åˆ¥èˆ‡å¾Œç«¯æœå‹™å±¤ä¹‹é–“çš„é€šä¿¡é—œä¿‚ï¼Œ**å®Œå…¨åŸºæ–¼å¯¦éš›APIå¯¦ä½œå’Œå‰ç«¯åŠŸèƒ½**ï¼Œæç¹ªäº†çœŸå¯¦çš„ç³»çµ±æ¶æ§‹æ¨¡å¼ã€‚

```mermaid
graph TB
    subgraph "å‰ç«¯å®¢æˆ¶ç«¯ (Frontend Client)"
        AuthClass[AuthClass<br/>èªè­‰ç®¡ç†]
        ProductClass[ProductClass<br/>å•†å“ç€è¦½]
        SellerClass[SellerClass<br/>è³£å®¶åŠŸèƒ½]
        BuyerClass[BuyerClass<br/>è²·å®¶åŠŸèƒ½]
        ChatClass[ChatClass<br/>èŠå¤©ç³»çµ±]
        AdminClass[AdminClass<br/>ç®¡ç†åŠŸèƒ½]
        ImageClass[ImageClass<br/>åœ–ç‰‡ç®¡ç†]
    end
    
    subgraph "å¾Œç«¯æœå‹™å±¤ (Backend Server API)"
        HealthServer[HealthServer<br/>ç³»çµ±å¥åº·æª¢æŸ¥]
        AuthServer[AuthServer<br/>èº«ä»½èªè­‰æœå‹™]
        ProductServer[ProductServer<br/>å•†å“æœå‹™]
        CategoryServer[CategoryServer<br/>åˆ†é¡æœå‹™]
        SellerServer[SellerServer<br/>è³£å®¶æœå‹™]
        BuyerServer[BuyerServer<br/>è²·å®¶æœå‹™]
        ChatServer[ChatServer<br/>èŠå¤©æœå‹™]
        ImageServer[ImageServer<br/>åœ–ç‰‡æœå‹™]
        AdminServer[AdminServer<br/>ç®¡ç†æœå‹™]
    end
    
    subgraph "è³‡æ–™å­˜å–å±¤ (Data Access Layer)"
        PrismaService[PrismaService<br/>è³‡æ–™åº«ORM]
        PostgreSQL[(PostgreSQL<br/>é—œä¿‚å‹è³‡æ–™åº«)]
    end
    
    subgraph "å¤–éƒ¨ä¾è³´ (External Dependencies)"
        JWT[JWT<br/>Tokenèªè­‰]
        WebSocket[WebSocket<br/>å³æ™‚é€šä¿¡]
        FileSystem[File System<br/>æª”æ¡ˆå­˜å„²]
        Email[Email Service<br/>éƒµä»¶æœå‹™]
    end
    
    %% HTTP API é€šä¿¡é—œä¿‚
    AuthClass -.->|HTTP API| AuthServer
    ProductClass -.->|HTTP API| ProductServer
    ProductClass -.->|HTTP API| CategoryServer
    SellerClass -.->|HTTP API| SellerServer
    SellerClass -.->|HTTP API| CategoryServer
    SellerClass -.->|HTTP API| ImageServer
    BuyerClass -.->|HTTP API| BuyerServer
    AdminClass -.->|HTTP API| AdminServer
    ImageClass -.->|HTTP API| ImageServer
    
    %% WebSocket å³æ™‚é€šä¿¡
    ChatClass -.->|WebSocket| ChatServer
    BuyerClass -.->|WebSocket| ChatServer
    SellerClass -.->|WebSocket| ChatServer
    AdminClass -.->|WebSocket| ChatServer
    
    %% å¾Œç«¯æœå‹™é–“ä¾è³´
    AuthServer --> PrismaService
    ProductServer --> PrismaService
    CategoryServer --> PrismaService
    SellerServer --> PrismaService
    BuyerServer --> PrismaService
    ChatServer --> PrismaService
    ImageServer --> PrismaService
    AdminServer --> PrismaService
    
    %% è³‡æ–™åº«é€£æ¥
    PrismaService --> PostgreSQL
    
    %% å¤–éƒ¨æœå‹™ä¾è³´
    AuthServer --> JWT
    AuthServer --> Email
    ChatServer --> WebSocket
    ImageServer --> FileSystem
    
    %% ç³»çµ±å¥åº·æª¢æŸ¥
    HealthServer -.->|System Check| PrismaService
    
    classDef frontend fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef backend fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef database fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef external fill:#fff3e0,stroke:#e65100,stroke-width:2px
    
    class AuthClass,ProductClass,SellerClass,BuyerClass,ChatClass,AdminClass,ImageClass frontend
    class HealthServer,AuthServer,ProductServer,CategoryServer,SellerServer,BuyerServer,ChatServer,ImageServer,AdminServer backend
    class PrismaService,PostgreSQL database
    class JWT,WebSocket,FileSystem,Email external
```

### æ™‚åºåœ– (Sequence Diagram) - çµå¸³æµç¨‹
æ™‚åºåœ–ï¼ˆæˆ–ç¨±å¾ªåºåœ–ï¼‰å°ˆé–€ç”¨æ–¼å±•ç¤ºå°è±¡ä¹‹é–“å¦‚ä½•éš¨è‘—æ™‚é–“çš„æ¨ç§»é€²è¡Œäº’å‹•ã€‚ä¸‹åœ–**å®Œå…¨åŸºæ–¼å¯¦éš›ç¨‹å¼ç¢¼å¯¦ç¾**ï¼Œè©³ç´°æç¹ªäº†è²·å®¶å¾ç™¼èµ·çµå¸³è«‹æ±‚åˆ°è¨‚å–®æˆåŠŸå‰µå»ºçš„çœŸå¯¦å¾Œç«¯è™•ç†æµç¨‹ã€‚

```mermaid
sequenceDiagram
    participant U as ğŸ›’ è²·å®¶
    participant OC as ğŸ“¦ OrderController
    participant OS as ğŸ“¦ OrderService
    participant PS as ğŸ—„ï¸ PrismaService
    participant DB as ğŸ—„ï¸ PostgreSQL
    participant LS as ğŸ“ LogService

    U->>OC: POST /buyers/me/checkout
    Note over U,OC: CheckoutDto: {cartItemIds?, shippingAddress, paymentMethod}
    
    OC->>OS: checkout(user.id, checkoutDto)
    
    OS->>PS: $transaction é–‹å§‹
    Note over OS,PS: ç¢ºä¿è³‡æ–™ä¸€è‡´æ€§çš„è³‡æ–™åº«äº¤æ˜“
    
    PS->>DB: cart.findUnique({where: {buyerId}, include: {items, productVariant, product}})
    DB-->>PS: è³¼ç‰©è»Šå®Œæ•´è³‡æ–™
    PS-->>OS: cart with items
    
    alt è³¼ç‰©è»Šç‚ºç©º
        OS-->>OC: throw BadRequestException('è³¼ç‰©è»Šç‚ºç©º')
        OC-->>U: 400 è³¼ç‰©è»Šç‚ºç©º
    end
    
    OS->>OS: ç¯©é¸çµå¸³é …ç›®
    Note over OS: æ ¹æ“šcartItemIdsæˆ–isSelectedç¯©é¸
    
    alt æŒ‡å®šé …ç›®ä¸å­˜åœ¨
        OS-->>OC: throw BadRequestException('æŒ‡å®šçš„è³¼ç‰©è»Šé …ç›®ä¸å­˜åœ¨')
        OC-->>U: 400 é …ç›®ä¸å­˜åœ¨
    end
    
    OS->>OS: æŒ‰è³£å®¶åˆ†çµ„å•†å“
    Note over OS: itemsBySeller = items.reduce(groupBySellerId)
    
    loop æ¯å€‹è³£å®¶çš„å•†å“ç¾¤çµ„
        OS->>OS: æª¢æŸ¥åº«å­˜å’Œå•†å“ç‹€æ…‹
        
        alt åº«å­˜ä¸è¶³
            OS-->>OC: throw BadRequestException('å•†å“åº«å­˜ä¸è¶³')
            OC-->>U: 400 åº«å­˜ä¸è¶³
        end
        
        alt å•†å“å·²ä¸‹æ¶
            OS-->>OC: throw BadRequestException('å•†å“å·²ä¸‹æ¶')
            OC-->>U: 400 å•†å“å·²ä¸‹æ¶
        end
        
        OS->>OS: è¨ˆç®—è¨‚å–®ç¸½é‡‘é¡
        
        OS->>PS: order.create({buyerId, sellerId, totalAmount, status: 'UNCOMPLETED', ...shippingAddress, paymentMethod})
        PS->>DB: INSERT INTO Order
        DB-->>PS: æ–°è¨‚å–®ID
        PS-->>OS: order object
        
        loop æ¯å€‹å•†å“é …ç›®
            OS->>PS: orderItem.create({orderId, productVariantId, quantity, unitPrice})
            PS->>DB: INSERT INTO OrderItem
            
            OS->>PS: productVariant.update({where: {id}, data: {stock: {decrement: quantity}}})
            PS->>DB: UPDATE ProductVariant SET stock = stock - quantity
        end
        
        OS->>PS: cartItem.deleteMany({where: {id: {in: itemIds}}})
        PS->>DB: DELETE FROM CartItem WHERE id IN (...)
    end
    
    OS->>LS: record('ORDER_CREATED', buyerId, description, undefined, {orderIds, cartItemIds})
    LS->>DB: INSERT INTO LogEntry
    Note over LS,DB: è¨˜éŒ„æ“ä½œæ—¥èªŒ
    
    PS->>OS: æäº¤äº¤æ˜“æˆåŠŸ
    OS-->>OC: è¿”å›è¨‚å–®é™£åˆ—
    OC-->>U: ResponseDto.created(orders, 'çµå¸³æˆåŠŸ')
```

### ğŸ—„ï¸ æ ¸å¿ƒæ•¸æ“šæ¨¡å‹ (ER Diagram)
å¯¦é«”é—œä¿‚åœ–ï¼ˆERDï¼‰å°ˆæ³¨æ–¼æ•¸æ“šåº«å±¤ç´šçš„è¡¨çµæ§‹èˆ‡å®ƒå€‘ä¹‹é–“çš„é—œè¯ã€‚ä¸‹åœ–æ˜¯æ ¹æ“šå°ˆæ¡ˆæ ¸å¿ƒ `schema.prisma` æ–‡ä»¶é‡æ–°ç¹ªè£½çš„ã€æœ€æ¬Šå¨çš„æ•¸æ“šæ¨¡å‹ï¼Œå®ƒç²¾æº–åœ°åæ˜ äº†ç³»çµ±ä¸­æ‰€æœ‰å¯¦é«”åŠå…¶çœŸå¯¦é—œä¿‚ã€‚

```mermaid
erDiagram
    User {
        Int id PK
        String account UK
        String passwordHash
        String username
        String email UK
        String phone
        Role role
        Boolean isBlocked
        String shopName
        String description
        DateTime createdAt
        DateTime updatedAt
    }

    Category {
        Int id PK
        String name UK
        DateTime createdAt
        DateTime updatedAt
    }

    Product {
        Int id PK
        Int sellerId FK
        Int categoryId FK
        String name
        String description
        ProductStatus status
        DateTime createdAt
        DateTime updatedAt
    }

    ProductVariant {
        Int id PK
        Int productId FK
        String name
        Int price
        Int stock
        Json attributes
        DateTime createdAt
        DateTime updatedAt
    }

    ProductImage {
        Int id PK
        Int productId FK
        String url
        DateTime createdAt
        DateTime updatedAt
    }

    Cart {
        Int id PK
        Int buyerId FK, UK
        DateTime createdAt
        DateTime updatedAt
    }

    CartItem {
        Int id PK
        Int cartId FK
        Int productVariantId FK
        Int quantity
        Int unitPrice
        Boolean isSelected
        DateTime createdAt
        DateTime updatedAt
    }

    Order {
        Int id PK
        Int buyerId FK
        Int sellerId FK
        Int totalAmount
        OrderStatus status
        String recipientName
        String recipientPhone
        String city
        String district
        String postalCode
        String address
        String notes
        PaymentMethod paymentMethod
        DateTime createdAt
        DateTime updatedAt
    }

    OrderItem {
        Int id PK
        Int orderId FK
        Int productVariantId FK
        Int quantity
        Int unitPrice
        DateTime createdAt
        DateTime updatedAt
    }

    Review {
        Int id PK
        Int productId FK
        Int orderId FK
        Int buyerId FK
        Int score
        String comment
        Boolean isEdited
        Boolean isDeleted
        DateTime createdAt
        DateTime updatedAt
    }

    ChatRoom {
        Int id PK
        Int buyerId FK
        Int sellerId FK
        DateTime createdAt
        DateTime updatedAt
    }

    ChatMessage {
        Int id PK
        Int roomId FK
        Int fromUserId FK
        String content
        Boolean isEdited
        Boolean isReadByBuyer
        Boolean isReadBySeller
        DateTime readByBuyerAt
        DateTime readBySellerAt
        DateTime createdAt
        DateTime updatedAt
    }

    LogEntry {
        Int id PK
        String event
        Int actorId FK
        String description
        String ipAddress
        Json meta
        DateTime createdAt
    }

    PasswordResetToken {
        Int id PK
        String email UK
        String token UK
        DateTime expiresAt
        DateTime createdAt
    }

    %% ç”¨æˆ¶é—œè¯
    User ||--o{ Product
    User ||--|| Cart
    User ||--o{ Order
    User ||--o{ Review
    User ||--o{ ChatMessage
    User ||--o{ ChatRoom
    User ||--o{ LogEntry
    
    %% å•†å“é—œè¯
    Category ||--o{ Product
    Product ||--o{ ProductVariant
    Product ||--o{ ProductImage
    Product ||--o{ Review
    
    %% è³¼ç‰©è»Šé—œè¯
    Cart ||--o{ CartItem
    ProductVariant ||--o{ CartItem
    
    %% è¨‚å–®é—œè¯
    Order ||--o{ OrderItem
    ProductVariant ||--o{ OrderItem
    Order ||--o{ Review
    
    %% èŠå¤©é—œè¯
    ChatRoom ||--o{ ChatMessage
```

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹èˆ‡å¯¦ç¾

### ğŸ¯ ç³»çµ±å®Œæ•´æ¶æ§‹åœ– (Full System Architecture)
æœ¬å°ˆæ¡ˆæ¡ç”¨äº†ç¾ä»£åŒ–çš„å‰å¾Œç«¯åˆ†é›¢æ¶æ§‹ï¼Œä¸¦é€é Nginx é€²è¡Œæœå‹™çš„çµ±ä¸€ä»£ç†èˆ‡åˆ†ç™¼ã€‚ä¸‹åœ–è©³ç´°æç¹ªäº†å¾ä½¿ç”¨è€…è«‹æ±‚åˆ°æ•¸æ“šåº«æ“ä½œçš„å®Œæ•´æµç¨‹èˆ‡åˆ†å±¤çµæ§‹ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       End User's Browser                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ (HTTP/HTTPS Requests to http://localhost)
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Web & Proxy Layer (Nginx)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Nginx (Reverse Proxy running in Docker)              â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ IF path starts with  â”‚ ELSE (Serve User Interface)     â”‚ â”‚
â”‚  â”‚ `/api` or `/socket.io` â”‚                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                       â”‚
              â”‚ (Proxy to Backend)    â”‚ (Proxy to Frontend)
              â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Application Layer       â”‚ â”‚     Presentation Layer        â”‚
â”‚    (Backend Service)      â”‚ â”‚      (Frontend Service)       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  Presentation Layer   â”‚ â”‚ â”‚ â”‚   Node.js/Express Server  â”‚ â”‚
â”‚ â”‚  â€¢ Controllers (API)  â”‚ â”‚ â”‚ â”‚    â€¢ Serves static files  â”‚ â”‚
â”‚ â”‚  â€¢ Gateways (Socket)  â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚            â”‚              â”‚ â”‚ â”‚   Browser UI (www/)       â”‚ â”‚
â”‚            â–¼              â”‚ â”‚ â”‚    â€¢ HTML, CSS, JS        â”‚ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚    Business Layer     â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ â”‚  â€¢ Services (Logic)   â”‚ â”‚
â”‚ â”‚  â€¢ DTOs (Validation)  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚            â”‚              â”‚
â”‚            â–¼              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚      Data Layer       â”‚ â”‚
â”‚ â”‚  â€¢ Prisma ORM         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ (Database Operations)
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Data Persistence Layer                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚  PostgreSQL            â”‚   â”‚  Redis                 â”‚  â”‚
â”‚    â”‚  (Relational Data)    â”‚   â”‚  (Cache, Sessions)     â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

###  decoupled-architecture å‰å¾Œç«¯åˆ†é›¢æ¶æ§‹ (Headless Architecture)
æœ¬å°ˆæ¡ˆé«”ç¾äº†ã€Œå‰å¾Œç«¯åˆ†é›¢ã€çš„è¨­è¨ˆç†å¿µã€‚å°ˆæ¡ˆä¸»è¦ç”±å…©å€‹ç¨ç«‹çš„éƒ¨åˆ†çµ„æˆï¼š
- **`backend/`**: ä¸€å€‹åŸºæ–¼ NestJS çš„å¼·å¤§å¾Œç«¯ API æœå‹™ï¼Œè² è²¬è™•ç†æ‰€æœ‰æ¥­å‹™é‚è¼¯ã€è³‡æ–™åº«äº’å‹•èˆ‡ä½¿ç”¨è€…èªè­‰ã€‚
- **`frontend/`**: ä¸€å€‹ç¨ç«‹çš„ç¶²é æ‡‰ç”¨ç¨‹å¼ï¼Œå®ƒé€é Node.js/Express ä¼ºæœå™¨æä¾›éœæ…‹ç”¨æˆ¶ç•Œé¢ã€‚é€™å€‹å‰ç«¯æ‡‰ç”¨é€éå‘¼å«å¾Œç«¯æä¾›çš„ API ä¾†å¯¦ç¾æ‰€æœ‰äº’å‹•åŠŸèƒ½ï¼Œèˆ‡å¾Œç«¯å®Œå…¨è§£è€¦ã€‚

é€™ç¨®æ¶æ§‹çš„æ ¸å¿ƒå„ªå‹¢åœ¨æ–¼ **éˆæ´»æ€§** èˆ‡ **å¯æ“´å±•æ€§**ï¼š
- **è§£è€¦é–‹ç™¼**: å¾Œç«¯åœ˜éšŠå¯ä»¥å°ˆæ³¨æ–¼ API æ•ˆèƒ½ï¼Œè€Œå‰ç«¯å¯ä»¥ç¨ç«‹é–‹ç™¼ç”¨æˆ¶ç•Œé¢ï¼Œå…©è€…åƒ…é€šé API é€²è¡Œæºé€šã€‚
- **ç¨ç«‹éƒ¨ç½²èˆ‡æ“´å±•**: å‰å¾Œç«¯å¯ä»¥ç¨ç«‹éƒ¨ç½²ã€æ›´æ–°èˆ‡æ“´å®¹ï¼Œæé«˜äº†ç³»çµ±çš„ç¶­è­·æ€§èˆ‡å½ˆæ€§ã€‚
- **å¤šç«¯æ”¯æ´æ½›åŠ›**: æœªä¾†å¯ä»¥åŸºæ–¼åŒä¸€å¥—å¾Œç«¯ APIï¼Œæ“´å±•æ”¯æ´åŸç”Ÿè¡Œå‹•æ‡‰ç”¨ (iOS/Android) ç­‰ä¸åŒå®¢æˆ¶ç«¯ã€‚

åœ¨æœ¬å°ˆæ¡ˆä¸­ï¼Œé™¤äº†å®Œæ•´çš„ `frontend` æ‡‰ç”¨å¤–ï¼Œå¾Œç«¯æœå‹™ä¾ç„¶ä¿ç•™äº† `public/api-tester.html`ï¼Œç‚ºé–‹ç™¼è€…æä¾›äº†ä¸€å€‹å¿«é€Ÿã€ä¾¿æ·çš„åº•å±¤ API æ¸¬è©¦å·¥å…·ã€‚

### ğŸ’» æŠ€è¡“æ£§é¸å‹
| å±¤ç´š | æŠ€è¡“ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|------|
| **é‹è¡Œç’°å¢ƒ** | Node.js | 18+ | JavaScript é‹è¡Œæ™‚ |
| **å¾Œç«¯æ¡†æ¶** | NestJS | 11.x | ä¼æ¥­ç´š Node.js æ¡†æ¶ |
| **æ•¸æ“šåº«** | PostgreSQL | 15+ | é—œè¯å‹æ•¸æ“šåº« |
| **ORM** | Prisma | 6.x | é¡å‹å®‰å…¨çš„æ•¸æ“šåº«å®¢æˆ¶ç«¯ |
| **èªè­‰** | JWT + Passport | - | ç„¡ç‹€æ…‹èº«ä»½é©—è­‰ |
| **å³æ™‚é€šè¨Š** | Socket.IO | 4.x | WebSocket å¯¦ç¾ |
| **å¿«å–** | Redis | 7+ | é«˜æ•ˆèƒ½å¿«å–ç³»çµ± |
| **å®¹å™¨åŒ–** | Docker | - | æ‡‰ç”¨ç¨‹å¼å®¹å™¨åŒ– |
| **åå‘ä»£ç†** | Nginx | - | è² è¼‰å‡è¡¡èˆ‡éœæ…‹è³‡æº |

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
Zipperoo/
â”œâ”€â”€ frontend/                   # ğŸŒ å‰ç«¯æ‡‰ç”¨
â”‚   â”œâ”€â”€ www/                   # ç¶²é éœæ…‹è³‡æº (HTML, CSS, JS)
â”‚   â”œâ”€â”€ server.js              # å•Ÿå‹•å‰ç«¯æœå‹™çš„ Express è…³æœ¬
â”‚   â”œâ”€â”€ Dockerfile             # å‰ç«¯æ‡‰ç”¨å®¹å™¨åŒ–é…ç½®
â”‚   â””â”€â”€ package.json           # å‰ç«¯ä¾è³´èˆ‡è…³æœ¬
â”‚
â”œâ”€â”€ backend/                    # ğŸš€ å¾Œç«¯æ ¸å¿ƒæ‡‰ç”¨ (NestJS)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ auth/              # ğŸ” èªè­‰æˆæ¬Šæ¨¡çµ„
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/           # ç™»å…¥ã€è¨»å†Šã€Token ç­‰ DTO
â”‚   â”‚   â”‚   â”œâ”€â”€ strategies/    # JWT/Local Passport ç­–ç•¥
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ auth.module.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ buyer/             # ğŸ›’ è²·å®¶åŠŸèƒ½æ¨¡çµ„
â”‚   â”‚   â”‚   â”œâ”€â”€ controllers/   # è³¼ç‰©è»Šã€çµå¸³ã€è¨‚å–®æŸ¥è©¢æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ services/      # æ ¸å¿ƒè³¼ç‰©æ¥­å‹™é‚è¼¯
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/           # è³¼ç‰©ç›¸é—œ DTO
â”‚   â”‚   â”‚   â””â”€â”€ buyer.module.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ seller/            # ğŸª è³£å®¶åŠŸèƒ½æ¨¡çµ„
â”‚   â”‚   â”‚   â”œâ”€â”€ controllers/   # å•†å“ç®¡ç†ã€è¨‚å–®è™•ç†æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ services/      # å•†å“ã€è¨‚å–®ã€è®Šé«”ç®¡ç†é‚è¼¯
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/           # å•†å“ã€è¨‚å–®ç›¸é—œ DTO
â”‚   â”‚   â”‚   â””â”€â”€ seller.module.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ admin/             # âš™ï¸ ç®¡ç†å“¡åŠŸèƒ½æ¨¡çµ„
â”‚   â”‚   â”‚   â”œâ”€â”€ admin.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ admin.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ admin.module.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ category/          # ğŸ“‚ å•†å“åˆ†é¡æ¨¡çµ„
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â”‚   â”œâ”€â”€ category.controller.ts
â”‚   â”‚   â”‚   â””â”€â”€ category.service.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ variant/           # ğŸ¨ å•†å“è®Šé«”æ¨¡çµ„
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â”‚   â”œâ”€â”€ variant.controller.ts
â”‚   â”‚   â”‚   â””â”€â”€ variant.service.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ review/            # â­ è©•åƒ¹ç³»çµ±æ¨¡çµ„
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â”‚   â”œâ”€â”€ review.controller.ts
â”‚   â”‚   â”‚   â””â”€â”€ review.service.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ chat/              # ğŸ’¬ å³æ™‚èŠå¤©æ¨¡çµ„
â”‚   â”‚   â”‚   â”œâ”€â”€ chat.gateway.ts   # WebSocket æ ¸å¿ƒé–˜é“
â”‚   â”‚   â”‚   â”œâ”€â”€ chat.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ chat.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ chat.module.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ image/             # ğŸ–¼ï¸ åœ–ç‰‡ç®¡ç†æ¨¡çµ„
â”‚   â”‚   â”‚   â”œâ”€â”€ image.controller.ts
â”‚   â”‚   â”‚   â””â”€â”€ image.service.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ common/            # ğŸ”§ å…±ç”¨æ¨¡çµ„èˆ‡å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ decorators/    # è‡ªå®šç¾©è£é£¾å™¨ (å¦‚: GetUser)
â”‚   â”‚   â”‚   â”œâ”€â”€ guards/        # æ¬Šé™å®ˆè¡› (å¦‚: RolesGuard)
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/           # å…±ç”¨åˆ†é ã€ID ç­‰ DTO
â”‚   â”‚   â”‚   â””â”€â”€ services/      # æ—¥èªŒç­‰å…±ç”¨æœå‹™
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ prisma/            # ğŸ—„ï¸ Prisma æ•¸æ“šåº«æ¨¡çµ„
â”‚   â”‚   â”‚   â”œâ”€â”€ prisma.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ prisma.module.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ health/            # â¤ï¸ å¥åº·æª¢æŸ¥ç«¯é»
â”‚   â”‚   â”œâ”€â”€ scripts/           # ğŸ“Š æ•¸æ“šå¡«å……è…³æœ¬ (seeding)
â”‚   â”‚   â””â”€â”€ main.ts            # ğŸš€ æ‡‰ç”¨ç¨‹å¼å…¥å£
â”‚   â”‚
â”‚   â”œâ”€â”€ prisma/                # ğŸ“‹ æ•¸æ“šåº« Schema èˆ‡é·ç§»
â”‚   â”‚   â”œâ”€â”€ schema.prisma      # æ•¸æ“šåº«æ¨¡å‹å®šç¾©æª”
â”‚   â”‚   â””â”€â”€ migrations/        # æ•¸æ“šåº«é·ç§»æ­·å²
â”‚   â”‚
â”‚   â”œâ”€â”€ public/                # ğŸŒ å¾Œç«¯æä¾›çš„éœæ…‹è³‡æº
â”‚   â”‚   â”œâ”€â”€ api-tester.html    # API æ¸¬è©¦ç•Œé¢
â”‚   â”‚   â”œâ”€â”€ api-tester-style.css
â”‚   â”‚   â””â”€â”€ api-tester-scripts.js
â”‚   â”‚
â”‚   â”œâ”€â”€ test/                  # ğŸ§ª å–®å…ƒæ¸¬è©¦èˆ‡ E2E æ¸¬è©¦
â”‚   â””â”€â”€ package.json           # ğŸ“¦ å¾Œç«¯å°ˆæ¡ˆä¾è³´
â”‚
â”œâ”€â”€ SystemDesign/              # ğŸ“‹ ç³»çµ±è¨­è¨ˆæ–‡æª”
â”‚   â”œâ”€â”€ APIStructure.md        # API æ¥å£è©³ç´°æ–‡æª”
â”‚   â”œâ”€â”€ requirement.txt        # åŸå§‹éœ€æ±‚è¦æ ¼æ›¸
â”‚   â”œâ”€â”€ usecase.wsd            # PlantUML ç”¨ä¾‹åœ–åŸå§‹æª”
â”‚   â””â”€â”€ api_endpoints_v1.csv   # API ç«¯é»åˆ—è¡¨
â”‚
â”œâ”€â”€ data/                      # ğŸ’¾ Docker æŒä¹…åŒ–æ•¸æ“šå·
â”‚   â”œâ”€â”€ postgres/              # PostgreSQL æ•¸æ“šç›®éŒ„
â”‚   â”œâ”€â”€ redis/                 # Redis æ•¸æ“šç›®éŒ„
â”‚   â””â”€â”€ uploads/               # ç”¨æˆ¶ä¸Šå‚³æ–‡ä»¶å­˜å„²
â”‚
â”œâ”€â”€ docker-compose.yml         # ğŸ³ å®¹å™¨ç·¨æ’é…ç½® (Nginx, Backend, Postgres, Redis)
â”œâ”€â”€ Dockerfile                 # ğŸ³ å¾Œç«¯æ‡‰ç”¨å®¹å™¨æ§‹å»ºé…ç½®
â”œâ”€â”€ nginx.conf                 # ğŸŒ Nginx åå‘ä»£ç†é…ç½®
â””â”€â”€ *.bat    
```

### ğŸ¯ æ¨¡çµ„è·è²¬åˆ†å·¥
- **ğŸ” Auth**: ç”¨æˆ¶èªè­‰ã€JWT ç®¡ç†ã€å¯†ç¢¼é‡è¨­
- **ğŸ›’ Buyer**: è³¼ç‰©è»Šç®¡ç†ã€çµå¸³æµç¨‹ã€è¨‚å–®æŸ¥è©¢
- **ğŸª Seller**: å•†å“ç®¡ç†ã€è¨‚å–®è™•ç†ã€éŠ·å”®çµ±è¨ˆ
- **âš™ï¸ Admin**: ç”¨æˆ¶ç®¡ç†ã€ç³»çµ±ç›£æ§ã€æ•¸æ“šçµ±è¨ˆ
- **ğŸ“‚ Category**: å•†å“åˆ†é¡ç®¡ç†ã€å±¤ç´šçµæ§‹
- **ğŸ¨ Variant**: å•†å“è®Šé«”ç®¡ç†ã€åº«å­˜æ§åˆ¶
- **â­ Review**: è©•åƒ¹ç®¡ç†ã€è©•åˆ†çµ±è¨ˆ
- **ğŸ’¬ Chat**: å³æ™‚èŠå¤©ã€æ¶ˆæ¯æ¨é€
- **ğŸ–¼ï¸ Image**: åœ–ç‰‡ä¸Šå‚³ã€å­˜å„²ç®¡ç†

## ğŸ†˜ å¿«é€Ÿé–‹å§‹

### ğŸ“‹ ç’°å¢ƒè¦æ±‚
- **Node.js**: 18.0+ (æ¨è–¦ LTS ç‰ˆæœ¬)
- **PostgreSQL**: 15.0+ (ç”Ÿç”¢ç’°å¢ƒæ¨è–¦)
- **Redis**: 7.0+ (å¯é¸ï¼Œç”¨æ–¼å¿«å–)
- **Docker**: 20.0+ (å®¹å™¨åŒ–éƒ¨ç½²)
- **Git**: æœ€æ–°ç‰ˆæœ¬

### âš¡ ä¸€éµå•Ÿå‹• (Windows)
```powershell
# ğŸ¯ ä½¿ç”¨è‡ªå‹•åŒ–è…³æœ¬ï¼Œå®Œæˆç’°å¢ƒè¨­ç½®èˆ‡æ‡‰ç”¨å•Ÿå‹•
.\start.bat

# ğŸ”„ é‡ç½®æ•¸æ“šåº«ä¸¦é‡æ–°å¡«å……æ¸¬è©¦æ•¸æ“š
.\seed.bat

# â¹ï¸ åœæ­¢æ‰€æœ‰æœå‹™
.\stop.bat
```

### ğŸ› ï¸ æ‰‹å‹•è¨­ç½®æ­¥é©Ÿ

#### 1. ğŸ“¥ å…‹éš†å°ˆæ¡ˆ
```bash
git clone https://github.com/Damian-Hsu/Mobile_Commerce_Final_Projec_Zipperoo.git
cd Mobile_Commerce_Final_Projec_Zipperoo
```

#### 2. ğŸ“¦ å®‰è£ä¾è³´
```bash
cd backend
npm install
```

#### 3. âš™ï¸ ç’°å¢ƒé…ç½®
è¤‡è£½ä¸¦é…ç½®ç’°å¢ƒè®Šæ•¸ï¼š
```bash
# è¤‡è£½ç’°å¢ƒé…ç½®ç¯„æœ¬
cp .env.example .env
```

`.env` é…ç½®èªªæ˜ (æ­¤æ–‡ä»¶æ‡‰æ”¾ç½®æ–¼ `/backend` ç›®éŒ„ä¸‹):
```env
# ğŸ—„ï¸ æ•¸æ“šåº«é…ç½®
# æ³¨æ„: åœ¨ Docker ç’°å¢ƒä¸­ï¼Œä¸»æ©Ÿåæ‡‰ç‚ºæœå‹™å (postgres)ï¼Œæœ¬åœ°é–‹ç™¼å‰‡ç‚º localhost
DATABASE_URL="postgresql://zipperoo:zipperoo123@localhost:5433/zipperoo_db?schema=public"

# ğŸ” JWT é…ç½® - ç”Ÿç”¢ç’°å¢ƒå‹™å¿…æ›´æ›ç‚ºé•·ä¸”éš¨æ©Ÿçš„å¯†é‘°
JWT_SECRET="your-super-secret-jwt-key-here"
JWT_EXPIRES_IN="24h"
REFRESH_JWT_SECRET="your-refresh-jwt-secret-here"
REFRESH_JWT_EXPIRES_IN="7d"

# ğŸŒ æœå‹™é…ç½®
PORT=3000
NODE_ENV="development"
# ç”Ÿç”¢ç’°å¢ƒä¸­æ‡‰æŒ‡å®šå‰ç«¯æœå‹™çš„åŸŸåï¼Œä¾‹å¦‚: http://your-domain.com
CORS_ORIGIN="*"

# ğŸ“§ éƒµä»¶é…ç½® (å¯é¸ï¼Œç”¨æ–¼æœªä¾†çš„å¯†ç¢¼é‡è¨­ç­‰åŠŸèƒ½)
MAIL_HOST="smtp.gmail.com"
MAIL_PORT=587
MAIL_USER="your-email@gmail.com"
MAIL_PASS="your-app-password"
```

#### 4. ğŸ³ å•Ÿå‹•åŸºç¤æœå‹™
```bash
# å•Ÿå‹• PostgreSQL å’Œ Redis
docker-compose up -d postgres redis

# æª¢æŸ¥æœå‹™ç‹€æ…‹
docker-compose ps
```

#### 5. ğŸ—„ï¸ æ•¸æ“šåº«åˆå§‹åŒ–
```bash
# é€²å…¥å¾Œç«¯ç›®éŒ„
cd backend

# ç”Ÿæˆ Prisma Client
npm run prisma:generate

# åŸ·è¡Œæ•¸æ“šåº«é·ç§»
npm run prisma:migrate

# å¡«å……æ¸¬è©¦æ•¸æ“š
npm run seed

# (å¯é¸) å•Ÿå‹•æ•¸æ“šåº«ç®¡ç†ç•Œé¢
npm run prisma:studio
```

#### 6. ğŸš€ å•Ÿå‹•æ‡‰ç”¨
```bash
# é–‹ç™¼æ¨¡å¼ (ç†±é‡è¼‰)
npm run start:dev

# ç”Ÿç”¢æ¨¡å¼
npm run build
npm run start:prod

# èª¿è©¦æ¨¡å¼
npm run start:debug
```

### ğŸ” æœå‹™é©—è­‰
- **ğŸŒ å¾Œç«¯ API**: http://localhost:3000
- **ğŸ§ª API æ¸¬è©¦ç•Œé¢**: http://localhost:3000/api-tester.html
- **â¤ï¸ å¥åº·æª¢æŸ¥**: http://localhost:3000/health
- **ğŸ—„ï¸ Prisma Studio**: http://localhost:5555
- **ğŸ“Š PostgreSQL**: localhost:5433
- **âš¡ Redis**: localhost:6379

## API æ¸¬è©¦å¹³å°

æœ¬å°ˆæ¡ˆå…§å»ºäº†ä¸€å€‹åŠŸèƒ½å¼·å¤§çš„ **API æ¸¬è©¦å¹³å°** (`api-tester.html`)ï¼Œå®ƒæ˜¯ä¸€å€‹ç´”æ‰‹åˆ»çš„å–®é é¢ Web æ‡‰ç”¨ï¼Œæ—¨åœ¨æä¾›ä¸€å€‹ç„¡éœ€ä»»ä½•å¤–éƒ¨å·¥å…·ï¼ˆå¦‚ Postmanï¼‰å³å¯é©—è­‰æ‰€æœ‰å¾Œç«¯åŠŸèƒ½çš„å®Œæ•´ç’°å¢ƒã€‚

### ğŸŒ è¨ªå•æ–¹å¼
åœ¨ `docker-compose` å•Ÿå‹•å¾Œï¼Œå¯é€éä»¥ä¸‹åœ°å€è¨ªå•ï¼š
**`http://localhost/api-tester.html`**

> **æ³¨æ„**: æ­¤è·¯å¾‘ç”± `nginx.conf` ä¸­çš„ç‰¹å®š `location` è¦å‰‡é€²è¡Œä»£ç†ï¼Œç¢ºä¿èƒ½ç›´æ¥è¨ªå•åˆ°å¾Œç«¯æœå‹™æä¾›çš„æ¸¬è©¦é é¢ã€‚

### âœ¨ å¹³å°çœŸå¯¦ç‰¹è‰²
é€éåˆ†æå…¶æ ¸å¿ƒè…³æœ¬ (`api-tester-scripts.js`)ï¼Œå¯è¦‹è©²å¹³å°å…·å‚™ä»¥ä¸‹å°ˆç‚ºæœ¬å°ˆæ¡ˆæ‰“é€ çš„ç‰¹è‰²åŠŸèƒ½ï¼š

- **ğŸ¨ UI/UX è¨­è¨ˆ**:
    - **éŸ¿æ‡‰å¼ä½ˆå±€**: ç•Œé¢ä½ˆå±€æ¸…æ™°ï¼Œå¯åœ¨ä¸åŒå°ºå¯¸çš„çª—å£ä¸‹ä½¿ç”¨ã€‚
    - **å¯æŠ˜ç–Šå€å¡Š**: æ‰€æœ‰ API æŒ‰è§’è‰²ï¼ˆé€šç”¨ã€è²·å®¶ã€è³£å®¶ã€ç®¡ç†å“¡ï¼‰å’ŒåŠŸèƒ½é€²è¡Œåˆ†çµ„ï¼Œä¸¦å¯ç¨ç«‹å±•é–‹/æŠ˜ç–Šï¼Œæ–¹ä¾¿èšç„¦ã€‚
    - **å³æ™‚éŸ¿æ‡‰è¦–çª—**: åœ¨å³å´æä¾›ä¸€å€‹èªæ³•é«˜äº®çš„è¦–çª—ï¼Œå³æ™‚é¡¯ç¤º API çš„è«‹æ±‚ç‹€æ…‹ï¼ˆåŠ è¼‰ä¸­ã€æˆåŠŸã€å¤±æ•—ï¼‰èˆ‡å®Œæ•´çš„è¿”å›æ•¸æ“šã€‚

- **ğŸ” èªè­‰èˆ‡æˆæ¬Š**:
    - **JWT è‡ªå‹•ç®¡ç†**: ç™»å…¥æˆåŠŸå¾Œï¼Œ`accessToken` æœƒè¢«è‡ªå‹•å­˜å…¥ `localStorage`ï¼Œå¾ŒçºŒæ‰€æœ‰éœ€è¦æˆæ¬Šçš„è«‹æ±‚å°‡è‡ªå‹•åœ¨æ¨™é ­ä¸­é™„åŠ  `Authorization: Bearer <token>`ã€‚
    - **ç‹€æ…‹é¡¯ç¤ºèˆ‡å¿«æ·æ“ä½œ**: é é¢é ‚éƒ¨æœƒå¯¦æ™‚é¡¯ç¤ºç•¶å‰çš„ç™»å…¥ç‹€æ…‹ï¼ˆç”¨æˆ¶åå’Œè§’è‰²ï¼‰ï¼Œä¸¦æä¾›ã€Œç™»å‡ºã€æŒ‰éˆ•ã€‚
    - **å¿«æ·ç™»å…¥æŒ‰éˆ•**: ç‚ºã€Œè²·å®¶ã€ã€ã€Œè³£å®¶ã€ã€ã€Œç®¡ç†å“¡ã€ä¸‰ç¨®è§’è‰²æä¾›äº†å¿«æ·ç™»å…¥æŒ‰éˆ•ï¼Œä¸€éµå¡«å……é è¨­å¸³å¯†ï¼Œæ¥µå¤§æå‡æ¸¬è©¦æ•ˆç‡ã€‚

- **ğŸš€ æ ¸å¿ƒåŠŸèƒ½æ”¯æŒ**:
    - **å…¨åŠŸèƒ½è¦†è“‹**: å¹³å°å®Œæ•´åœ°æš´éœ²äº†å¾Œç«¯æ‰€æœ‰ `v1` ç‰ˆæœ¬çš„ API æ¥å£ï¼Œå¾è¨»å†Šã€å•†å“ç®¡ç†åˆ°è¨‚å–®è™•ç†å’Œç®¡ç†å“¡ç›£æ§ã€‚
    - **æ”¯æ´æ–‡ä»¶ä¸Šå‚³**: å…§å»ºäº†é‡å° `multipart/form-data` çš„è«‹æ±‚è™•ç†é‚è¼¯ï¼Œå¯ä»¥ç›´æ¥åœ¨é é¢ä¸Šé¸æ“‡åœ–ç‰‡æ–‡ä»¶ä¸¦ä¸Šå‚³ã€‚
    - **å‹•æ…‹åƒæ•¸è¼¸å…¥**: å¤§éƒ¨åˆ† API çš„è·¯å¾‘åƒæ•¸ï¼ˆå¦‚ `productId`, `orderId`ï¼‰éƒ½è¨­è¨ˆç‚ºå¯ç”±ç”¨æˆ¶æ‰‹å‹•è¼¸å…¥ï¼Œæ–¹ä¾¿å°ç‰¹å®šå°è±¡é€²è¡Œæ“ä½œã€‚

### ğŸ‘¥ é è¨­æ¸¬è©¦å¸³è™Ÿ
ä½¿ç”¨ `seed.bat` æˆ– `npm run seed` å‘½ä»¤å‰µå»ºçš„æ¸¬è©¦å¸³è™Ÿï¼š

| è§’è‰² | å¸³è™Ÿ | å¯†ç¢¼ | åŠŸèƒ½ç¯„åœ |
|------|------|------|----------|
| ğŸ”§ **ç®¡ç†å“¡** | `admin` | `s11114020` | ç³»çµ±ç®¡ç†ã€ç”¨æˆ¶æ§åˆ¶ã€æ•¸æ“šçµ±è¨ˆ |
| ğŸª **è³£å®¶** | `seller` | `cyut123456` | å•†å“ç®¡ç†ã€è¨‚å–®è™•ç†ã€å®¢æœèŠå¤© |
| ğŸ›’ **è²·å®¶** | `buyer` | `cyut123456` | è³¼ç‰©æµç¨‹ã€è¨‚å–®æŸ¥è©¢ã€å•†å“è©•åƒ¹ |

### ğŸ¯ æ¨è–¦æ¸¬è©¦æµç¨‹ (API å¯¦æˆ°æŒ‡å—)

æœ¬ç¯€æä¾›äº†ä¸€å¥—å®Œæ•´çš„ç«¯åˆ°ç«¯ï¼ˆEnd-to-Endï¼‰æ¸¬è©¦æµç¨‹ï¼Œæ‚¨å¯ä»¥é€éå…§å»ºçš„ **API æ¸¬è©¦å¹³å°** æˆ–ä½¿ç”¨ `curl` ç­‰å·¥å…·ï¼Œè·Ÿéš¨ä»¥ä¸‹æ­¥é©Ÿä¾†é©—è­‰ç³»çµ±çš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ã€‚

---

#### ğŸ›’ è²·å®¶æ ¸å¿ƒè³¼ç‰©æµç¨‹ (End-to-End)

é€™å€‹æµç¨‹æ¨¡æ“¬ä¸€ä½è²·å®¶å¾ç™»å…¥ã€ç€è¦½å•†å“åˆ°å®Œæˆè¨‚å–®çš„å®Œæ•´é«”é©—ã€‚

**1. ç™»å…¥å–å¾— Token**
é¦–å…ˆï¼Œè²·å®¶éœ€è¦ç™»å…¥ä»¥ç²å– JWTï¼Œå¾ŒçºŒæ‰€æœ‰æ“ä½œéƒ½éœ€è¦åœ¨è«‹æ±‚æ¨™é ­ä¸­åŠ å…¥ `Authorization: Bearer <your_token>`ã€‚
- **API**: `POST /api/v1/auth/login`
- **ç¯„ä¾‹**:
  ```bash
  # åŸ·è¡Œå¾Œæœƒè¿”å› access_tokenï¼Œè«‹è¤‡è£½å®ƒ
  curl -X POST http://localhost/api/v1/auth/login \
    -H "Content-Type: application/json" \
    -d '{"account":"buyer","password":"cyut123456"}'
  ```

**2. ç€è¦½èˆ‡æœå°‹å•†å“**
è²·å®¶å¯ä»¥ç€è¦½æ‰€æœ‰ä¸Šæ¶å•†å“ï¼Œä¸¦ä½¿ç”¨é—œéµå­—ã€åˆ†é¡é€²è¡Œæœå°‹èˆ‡ç¯©é¸ã€‚
- **API**: `GET /api/v1/products`
- **ç¯„ä¾‹ (æœå°‹åç¨±åŒ…å« "Classic" çš„å•†å“)**:
  ```bash
  curl -X GET "http://localhost/api/v1/products?searchTerm=Classic"
  ```
  > ğŸ“ **æç¤º**: è¨˜ä¸‹æ‚¨æ„Ÿèˆˆè¶£çš„å•†å“ `id` å’Œ `variant` `id`ï¼Œå¾ŒçºŒæ­¥é©Ÿæœƒç”¨åˆ°ã€‚

**3. åŠ å…¥è³¼ç‰©è»Š**
å°‡é¸å®šçš„å•†å“è®Šé«”åŠ å…¥è³¼ç‰©è»Šã€‚
- **API**: `POST /api/v1/buyer/cart/items`
- **ç¯„ä¾‹ (å°‡ä¸€å€‹å•†å“è®Šé«”åŠ å…¥è³¼ç‰©è»Š)**:
  ```bash
  # å°‡ <your_token> å’Œ <variant_id> æ›¿æ›ç‚ºå¯¦éš›å€¼
  curl -X POST http://localhost/api/v1/buyer/cart/items \
    -H "Authorization: Bearer <your_token>" \
    -H "Content-Type: application/json" \
    -d '{"productVariantId": "<variant_id>", "quantity": 1}'
  ```

**4. åŸ·è¡Œçµå¸³**
å°‡è³¼ç‰©è»Šä¸­çš„å•†å“è½‰åŒ–ç‚ºä¸€å¼µå¾…è™•ç†çš„è¨‚å–®ã€‚
- **API**: `POST /api/v1/buyer/checkout`
- **ç¯„ä¾‹**:
  ```bash
  curl -X POST http://localhost/api/v1/buyer/checkout \
    -H "Authorization: Bearer <your_token>"
  ```
  > ğŸ“ **æç¤º**: è¨˜ä¸‹è¿”å›çš„è¨‚å–® `id`ã€‚

**5. æŸ¥çœ‹æˆ‘çš„è¨‚å–®**
- **API**: `GET /api/v1/buyer/orders`
- **ç¯„ä¾‹**:
  ```bash
  curl -X GET http://localhost/api/v1/buyer/orders \
    -H "Authorization: Bearer <your_token>"
  ```

---

#### ğŸª è³£å®¶å•†å“èˆ‡è¨‚å–®ç®¡ç†æµç¨‹

é€™å€‹æµç¨‹å±•ç¤ºäº†è³£å®¶å¦‚ä½•ç®¡ç†è‡ªå·±çš„å•†å“ï¼Œä¸¦è™•ç†ä¾†è‡ªè²·å®¶çš„è¨‚å–®ã€‚

**1. ç™»å…¥å–å¾— Token**
- **API**: `POST /api/v1/auth/login`
- **ç¯„ä¾‹**:
  ```bash
  curl -X POST http://localhost/api/v1/auth/login \
    -H "Content-Type: application/json" \
    -d '{"account":"seller","password":"cyut123456"}'
  ```

**2. å‰µå»ºä¸€å€‹æ–°å•†å“**
- **API**: `POST /api/v1/seller/products`
- **ç¯„ä¾‹**:
  ```bash
  # è¨˜å¾—æ›¿æ› <your_token> å’Œ <category_id>
  curl -X POST http://localhost/api/v1/seller/products \
    -H "Authorization: Bearer <your_token>" \
    -H "Content-Type: application/json" \
    -d '{"name": "æ–°æ¬¾æ½®æµå¤–å¥—", "description": "2025 ç§‹å†¬æœ€æ–°æ¬¾", "categoryId": "<category_id>"}'
  ```
  > ğŸ“ **æç¤º**: è¨˜ä¸‹è¿”å›çš„å•†å“ `id`ã€‚

**3. ç‚ºå•†å“æ·»åŠ è®Šé«” (SKU)**
- **API**: `POST /api/v1/seller/products/:productId/variants`
- **ç¯„ä¾‹ (ç‚ºå‰›æ‰çš„å•†å“æ·»åŠ  "ç´…è‰², Lè™Ÿ" çš„è®Šé«”)**:
  ```bash
  # è¨˜å¾—æ›¿æ› <your_token> å’Œ <product_id>
  curl -X POST http://localhost/api/v1/seller/products/<product_id>/variants \
    -H "Authorization: Bearer <your_token>" \
    -H "Content-Type: application/json" \
    -d '{"name": "ç´…è‰², L", "price": 1299, "stock": 50}'
  ```

**4. è™•ç†è¨‚å–®**
æŸ¥çœ‹æ”¶åˆ°çš„è¨‚å–®ï¼Œä¸¦æ›´æ–°å…¶ç‹€æ…‹ï¼ˆä¾‹å¦‚ï¼šå¾ `PENDING` æ›´æ–°ç‚º `SHIPPED`ï¼‰ã€‚
- **API**: `PATCH /api/v1/seller/orders/:orderId`
- **ç¯„ä¾‹ (å°‡è¨‚å–®æ¨™è¨˜ç‚ºå·²å‡ºè²¨)**:
  ```bash
  # è¨˜å¾—æ›¿æ› <your_token> å’Œ <order_id>
  curl -X PATCH http://localhost/api/v1/seller/orders/<order_id> \
    -H "Authorization: Bearer <your_token>" \
    -H "Content-Type: application/json" \
    -d '{"status": "SHIPPED"}'
  ```

---

#### ğŸ”§ ç®¡ç†å“¡ç³»çµ±ç›£æ§æµç¨‹

æ­¤æµç¨‹å±•ç¤ºç®¡ç†å“¡å¦‚ä½•ç›£æ§ç³»çµ±ä¸­çš„ç”¨æˆ¶èˆ‡å•†å“ã€‚

**1. ç™»å…¥å–å¾— Token**
- **API**: `POST /api/v1/auth/login`
- **ç¯„ä¾‹**:
  ```bash
  curl -X POST http://localhost/api/v1/auth/login \
    -H "Content-Type: application/json" \
    -d '{"account":"admin","password":"s11114020"}'
  ```

**2. ç®¡ç†ä½¿ç”¨è€…**
æŸ¥çœ‹ç³»çµ±ä¸­æ‰€æœ‰ç”¨æˆ¶ï¼Œä¸¦å¯ä»¥å°å…¶é€²è¡Œæ“ä½œï¼ˆä¾‹å¦‚ï¼šå°é–ï¼‰ã€‚
- **API**: `PATCH /api/v1/admin/users/:userId/status`
- **ç¯„ä¾‹ (å°é–æŸä½ä½¿ç”¨è€…)**:
  ```bash
  # è¨˜å¾—æ›¿æ› <your_token> å’Œ <user_id>
  curl -X PATCH http://localhost/api/v1/admin/users/<user_id>/status \
    -H "Authorization: Bearer <your_token>" \
    -H "Content-Type: application/json" \
    -d '{"isBlocked": true}'
  ```

### ğŸ”§ å¿«é€Ÿé‡ç½®ç’°å¢ƒ
```bash
# é‡ç½®æ•¸æ“šåº«ä¸¦é‡æ–°å¡«å……æ¸¬è©¦æ•¸æ“š
npm run db:reset

# æˆ–ä½¿ç”¨ Windows æ‰¹æ¬¡æª”
.\seed.bat
```

### ğŸ¨ æ¸¬è©¦å¹³å°ç•Œé¢é è¦½
- **ğŸ¯ åŠŸèƒ½åˆ†å€**: æŒ‰è§’è‰²å’ŒåŠŸèƒ½æ¨¡çµ„åˆ†é¡
- **ğŸ“ è«‹æ±‚ç·¨è¼¯å™¨**: JSON æ ¼å¼åŒ–ã€èªæ³•é«˜äº®
- **ğŸ“Š éŸ¿æ‡‰æª¢è¦–å™¨**: çµæ§‹åŒ–é¡¯ç¤ºã€éŒ¯èª¤çªå‡º
- **ğŸ” æœå°‹éæ¿¾**: å¿«é€Ÿå®šä½ API ç«¯é»
- **ğŸ’¾ è«‹æ±‚æ­·å²**: ä¿å­˜å¸¸ç”¨æ¸¬è©¦æ¡ˆä¾‹

## ğŸ³ Docker å®¹å™¨åŒ–éƒ¨ç½²

### ğŸš€ ä¸€éµéƒ¨ç½²
```bash
# å•Ÿå‹•å®Œæ•´çš„å¾®æœå‹™æ¶æ§‹
docker-compose up -d

# æŸ¥çœ‹æ‰€æœ‰æœå‹™ç‹€æ…‹
docker-compose ps

# å¯¦æ™‚æŸ¥çœ‹æ—¥èªŒ
docker-compose logs -f

# åœæ­¢æ‰€æœ‰æœå‹™
docker-compose down
```

### ğŸ—ï¸ æœå‹™æ¶æ§‹ (Nginx åå‘ä»£ç†)
ä¸‹åœ–å±•ç¤ºäº†ç³»çµ±åœ¨ Docker ç’°å¢ƒä¸‹çš„å®Œæ•´æœå‹™æ¶æ§‹ã€‚æ‰€æœ‰å¤–éƒ¨æµé‡éƒ½ç”± Nginx çµ±ä¸€æ¥æ”¶ï¼Œä¸¦æ ¹æ“šè«‹æ±‚è·¯å¾‘æ™ºèƒ½åœ°åˆ†ç™¼åˆ°å¾Œç«¯ API æœå‹™æˆ–å‰ç«¯æ‡‰ç”¨æœå‹™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       External Traffic                      â”‚
â”‚                      (Port 80, 443)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Load Balancer / Reverse Proxy             â”‚
â”‚                         Nginx                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ IF path starts with â”‚ ELSE (Serve static files)             â”‚
â”‚       /api          â”‚                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                â”‚
           â–¼                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Frontend Service      â”‚   â”‚     Backend Service       â”‚
â”‚  (Node.js + Express)      â”‚   â”‚      (NestJS)             â”‚
â”‚  â€¢ æä¾›ä½¿ç”¨è€…ä»‹é¢           â”‚   â”‚  â€¢ RESTful API            â”‚
â”‚  â€¢ éœæ…‹æª”æ¡ˆ (HTML/CSS)    â”‚   â”‚  â€¢ WebSocket              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Data Layer                        â”‚
â”‚         PostgreSQL             â”‚           Redis            â”‚
â”‚      â€¢ æ ¸å¿ƒæ•¸æ“šå­˜å„²            â”‚         â€¢ å¿«å–æœå‹™         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


### ğŸ“Š æœå‹™ç«¯é»
| æœå‹™ | å…§éƒ¨ç«¯å£ | å¤–éƒ¨ç«¯å£ | æè¿° |
|------|----------|----------|------|
| **Nginx** | 80 | 80/443 | ç³»çµ±å”¯ä¸€å…¥å£ï¼Œä½œç‚ºåå‘ä»£ç†ï¼Œè² è²¬ SSL çµ‚æ­¢èˆ‡æµé‡åˆ†ç™¼ã€‚ |
| **Frontend** | 8080 | (ç”± Nginx ä»£ç†) | æä¾›ç”¨æˆ¶æ“ä½œç•Œé¢çš„ Web æ‡‰ç”¨ç¨‹å¼ã€‚ |
| **Backend** | 3000 | (ç”± Nginx ä»£ç†) | æ ¸å¿ƒå¾Œç«¯ API æœå‹™ (NestJS)ï¼Œè™•ç†æ‰€æœ‰æ¥­å‹™é‚è¼¯ã€‚ |
| **PostgreSQL**| 5432 | 5433 | ä¸»æ•¸æ“šåº«ï¼Œç”¨æ–¼æŒä¹…åŒ–å­˜å„²æ ¸å¿ƒæ¥­å‹™æ•¸æ“šã€‚ |
| **Redis** | 6379 | 6379 | é«˜æ•ˆèƒ½å¿«å–æœå‹™ï¼Œç”¨æ–¼ Sessionã€å¿«å–ç­‰ã€‚ |

### ğŸ”§ å®¹å™¨ç®¡ç†
```bash
# ğŸ” æŸ¥çœ‹æ‰€æœ‰æœå‹™ç‹€æ…‹
docker-compose ps

# ğŸ“Š å¯¦æ™‚æŸ¥çœ‹æ‰€æœ‰å®¹å™¨è³‡æºä½¿ç”¨
docker stats

# ğŸ—‚ï¸ æŸ¥çœ‹ç‰¹å®šæœå‹™æ—¥èªŒ
docker-compose logs -f frontend
docker-compose logs -f backend
docker-compose logs -f postgres

# ğŸ”„ é‡å•Ÿç‰¹å®šæœå‹™
docker-compose restart backend

# ğŸ§¹ æ¸…ç†åœæ­¢çš„å®¹å™¨èˆ‡å­¤ç«‹ç¶²çµ¡
docker-compose down --remove-orphans

# ğŸ—‘ï¸ å®Œå…¨æ¸…ç†ï¼ˆåŒ…å«æ•¸æ“šå·ï¼Œæ­¤æ“ä½œæœƒåˆªé™¤æ•¸æ“šåº«ï¼ï¼‰
docker-compose down -v
```

### ğŸ’¾ æ•¸æ“šæŒä¹…åŒ–
- **PostgreSQL**: `./data/postgres/` - æ•¸æ“šåº«æ–‡ä»¶
- **Redis**: `./data/redis/` - å¿«å–æ–‡ä»¶  
- **Uploads**: `./data/uploads/` - ç”¨æˆ¶ä¸Šå‚³æ–‡ä»¶

### ğŸš€ ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²

#### ç’°å¢ƒé…ç½®
```bash
# è¨­ç½®ç”Ÿç”¢ç’°å¢ƒè®Šæ•¸
export NODE_ENV=production
export DATABASE_URL="postgresql://user:pass@prod-db:5432/db"
export JWT_SECRET="your-production-secret"
```

#### SSL é…ç½®
```nginx
# nginx.conf - HTTPS é…ç½®
server {
    listen 443 ssl;
    ssl_certificate /etc/ssl/certs/your-cert.pem;
    ssl_certificate_key /etc/ssl/private/your-key.pem;
    
    location / {
        proxy_pass http://backend:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

#### ç›£æ§èˆ‡å‚™ä»½
```bash
# æ•¸æ“šåº«å‚™ä»½
docker-compose exec postgres pg_dump -U zipperoo zipperoo_db > backup.sql

# æ¢å¾©æ•¸æ“šåº«
docker-compose exec -T postgres psql -U zipperoo zipperoo_db < backup.sql

# æŸ¥çœ‹å®¹å™¨å¥åº·ç‹€æ…‹
docker-compose exec backend curl http://localhost:3000/health
```

## ğŸ§ª æ¸¬è©¦èˆ‡å“è³ªä¿è­‰

### ğŸ¯ æ¸¬è©¦ç­–ç•¥
æœ¬å°ˆæ¡ˆæ¡ç”¨å¤šå±¤æ¬¡çš„æ¸¬è©¦ç­–ç•¥ï¼Œç¢ºä¿ä»£ç¢¼å“è³ªå’Œç³»çµ±ç©©å®šæ€§ï¼š

```
ğŸ—ï¸ æ¸¬è©¦é‡‘å­—å¡”
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚   E2E Tests â”‚  â† å®Œæ•´æ¥­å‹™æµç¨‹æ¸¬è©¦
                     â”‚    (å°‘é‡)    â”‚
                 â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
                 â”‚  Integration Tests  â”‚  â† API ç«¯é»é›†æˆæ¸¬è©¦
                 â”‚      (é©é‡)        â”‚
             â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
             â”‚      Unit Tests            â”‚  â† å–®å…ƒé‚è¼¯æ¸¬è©¦
             â”‚        (å¤§é‡)              â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”¬ å–®å…ƒæ¸¬è©¦
```bash
# åŸ·è¡Œæ‰€æœ‰å–®å…ƒæ¸¬è©¦
npm run test

# ç›£è½æ¨¡å¼ï¼ˆé–‹ç™¼æ™‚ä½¿ç”¨ï¼‰
npm run test:watch

# ç”Ÿæˆæ¸¬è©¦è¦†è“‹ç‡å ±å‘Š
npm run test:cov

# èª¿è©¦æ¨¡å¼
npm run test:debug
```

**æ¸¬è©¦è¦†è“‹ç‡ç›®æ¨™**: > 85%
- Services: > 90%
- Controllers: > 80%  
- DTOs: > 75%

### ğŸ”— é›†æˆæ¸¬è©¦
```bash
# åŸ·è¡Œ E2E æ¸¬è©¦
npm run test:e2e

# æŒ‡å®šæ¸¬è©¦æ–‡ä»¶
npm run test:e2e -- auth.e2e-spec.ts
```

### ğŸ­ æ¸¬è©¦å ´æ™¯è¦†è“‹

#### ğŸ” èªè­‰æµç¨‹æ¸¬è©¦
```typescript
describe('Authentication Flow', () => {
  it('ç”¨æˆ¶è¨»å†Š â†’ ç™»å…¥ â†’ ç²å–è³‡æ–™ â†’ ç™»å‡º');
  it('JWT Token é©—è­‰å’Œåˆ·æ–°');
  it('å¯†ç¢¼é‡è¨­æµç¨‹');
  it('æ¬Šé™æ§åˆ¶å’Œè§’è‰²é©—è­‰');
});
```

#### ğŸ›’ é›»å•†æ ¸å¿ƒæµç¨‹æ¸¬è©¦
```typescript
describe('E-commerce Core Flow', () => {
  it('å•†å“å‰µå»º â†’ è®Šé«”ç®¡ç† â†’ åœ–ç‰‡ä¸Šå‚³');
  it('å•†å“ç€è¦½ â†’ æœå°‹ç¯©é¸ â†’ è©³æƒ…æŸ¥çœ‹');
  it('åŠ å…¥è³¼ç‰©è»Š â†’ æ•¸é‡èª¿æ•´ â†’ çµå¸³æµç¨‹');
  it('è¨‚å–®å‰µå»º â†’ ç‹€æ…‹è¿½è¹¤ â†’ å®Œæˆè©•åƒ¹');
});
```

#### ğŸ’¬ å³æ™‚åŠŸèƒ½æ¸¬è©¦
```typescript
describe('Real-time Features', () => {
  it('WebSocket é€£æ¥å’Œæ–·é–‹');
  it('èŠå¤©å®¤å‰µå»ºå’Œè¨Šæ¯ç™¼é€');
  it('å¤šç”¨æˆ¶åŒæ™‚èŠå¤©');
  it('è¨Šæ¯æ­·å²å’Œç‹€æ…‹åŒæ­¥');
});
```


## ğŸ“„ API æ–‡ä»¶èˆ‡è¨­è¨ˆ

### ğŸ“š API æ–‡æª”ç”Ÿæˆ
- ä½¿ç”¨ `@nestjs/swagger` è‡ªå‹•ç”Ÿæˆ API æ–‡æª”
- æ–‡æª”è·¯å¾‘ï¼š`/api/docs`

### ğŸ¨ API æ–‡ä»¶ç¯„æœ¬
```typescript
/**
 * @swagger
 * tags:
 *   - name: Auth
 *     description: ç”¨æˆ¶èªè­‰ç›¸é—œæ“ä½œ
 */

/**
 * @swagger
 * /api/v1/auth/register:
 *   post:
 *     tags: [Auth]
 *     summary: ç”¨æˆ¶è¨»å†Š
 *     requestBody:
 *       required: true
 *       content:
 *         application/json:
 *           schema:
 *             type: object
 *             properties:
 *               account:
 *                 type: string
 *                 example: buyer
 *               password:
 *                 type: string
 *                 example: 123456
 *               email:
 *                 type: string
 *                 example: buyer@example.com
 *     responses:
 *       201:
 *         description: è¨»å†ŠæˆåŠŸ
 *       400:
 *         description: è«‹æ±‚åƒæ•¸éŒ¯èª¤
 *       409:
 *         description: ç”¨æˆ¶å·²å­˜åœ¨
 */
```

### ğŸ”„ API ç‰ˆæœ¬ç®¡ç†
- ä½¿ç”¨è·¯ç”±ç‰ˆæœ¬æ§åˆ¶ï¼Œä¿æŒå‘å¾Œç›¸å®¹æ€§
- ç›®å‰ç‰ˆæœ¬ï¼š`v1`

### ğŸ“¦ API æ¸¬è©¦å·¥å…·æ•´åˆ
- é›†æˆ Postman å’Œ Swagger UI é€²è¡Œ API æ¸¬è©¦
- æä¾›æ¸¬è©¦ç”¨çš„ Postman é›†åˆå’Œç’°å¢ƒè®Šæ•¸æ–‡ä»¶

## ğŸ†˜ æ•…éšœæ’é™¤æŒ‡å—

### ğŸ”§ å¸¸è¦‹å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

#### ğŸ—„ï¸ è³‡æ–™åº«é€£ç·šå•é¡Œ
```bash
# å•é¡Œï¼šDatabase connection failed
# åŸå› ï¼šPostgreSQL æœå‹™æœªå•Ÿå‹•æˆ–é…ç½®éŒ¯èª¤

# è§£æ±ºæ­¥é©Ÿï¼š
# 1. æª¢æŸ¥å®¹å™¨ç‹€æ…‹
docker-compose ps

# 2. æŸ¥çœ‹è³‡æ–™åº«æ—¥èªŒ
docker-compose logs postgres

# 3. æª¢æŸ¥é€£ç·šé…ç½®
echo $DATABASE_URL

# 4. æ¸¬è©¦é€£ç·š
docker-compose exec postgres psql -U zipperoo zipperoo_db -c "SELECT 1;"

# 5. é‡å•Ÿè³‡æ–™åº«æœå‹™
docker-compose restart postgres
```

#### ğŸ” JWT èªè­‰å¤±æ•—
```bash
# å•é¡Œï¼šJWT verification failed
# åŸå› ï¼šToken éæœŸæˆ– JWT_SECRET ä¸åŒ¹é…

# è§£æ±ºæ­¥é©Ÿï¼š
# 1. æª¢æŸ¥ç’°å¢ƒè®Šæ•¸
echo $JWT_SECRET

# 2. é‡æ–°ç™»å…¥ç²å–æ–° Token
curl -X POST http://localhost:3000/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"account":"buyer","password":"123456"}'

# 3. æª¢æŸ¥ç³»çµ±æ™‚é–“æ˜¯å¦æ­£ç¢º
date
```

#### ğŸŒ WebSocket é€£ç·šå•é¡Œ
```bash
# å•é¡Œï¼šWebSocket connection failed
# åŸå› ï¼šCORS é…ç½®æˆ–é˜²ç«ç‰†é˜»æ“‹

# è§£æ±ºæ­¥é©Ÿï¼š
# 1. æª¢æŸ¥ CORS è¨­å®š
echo $CORS_ORIGIN

# 2. æª¢æŸ¥é˜²ç«ç‰†è¨­å®š
netstat -an | findstr :3000
```

#### ğŸ“¦ Node.js æ¨¡çµ„éŒ¯èª¤
```powershell
# å•é¡Œï¼šModule not found or version conflict
# åŸå› ï¼šä¾è³´ç‰ˆæœ¬ä¸åŒ¹é…æˆ–å®‰è£ä¸å®Œæ•´

# è§£æ±ºæ­¥é©Ÿï¼š
cd backend

# 1. æ¸…ç† node_modules
Remove-Item -Recurse -Force node_modules
Remove-Item package-lock.json

# 2. é‡æ–°å®‰è£ä¾è³´
npm install

# 3. æª¢æŸ¥ Node.js ç‰ˆæœ¬
node --version  # æ‡‰è©² >= 18.0.0

# 4. æ¸…ç† npm å¿«å–
npm cache clean --force
```

### ğŸ” è¨ºæ–·å·¥å…·

#### ç³»çµ±å¥åº·æª¢æŸ¥è…³æœ¬
```powershell
# health-check.ps1
function Test-ZipperooSystem {
    Write-Host "ğŸ” Zipperoo ç³»çµ±è¨ºæ–·" -ForegroundColor Cyan
    
    # æª¢æŸ¥ Docker æœå‹™
    try {
        docker --version | Out-Null
        Write-Host "âœ… Docker æœå‹™æ­£å¸¸" -ForegroundColor Green
    } catch {
        Write-Host "âŒ Docker æœå‹™ç•°å¸¸" -ForegroundColor Red
    }
    
    # æª¢æŸ¥ API ç«¯é»
    try {
        $response = Invoke-RestMethod -Uri "http://localhost:3000/health" -TimeoutSec 5
        Write-Host "âœ… API æœå‹™æ­£å¸¸" -ForegroundColor Green
    } catch {
        Write-Host "âŒ API æœå‹™ç•°å¸¸: $($_.Exception.Message)" -ForegroundColor Red
    }
}

Test-ZipperooSystem
```

#### ç–‘é›£æ’è§£æª¢æŸ¥æ¸…å–®
- [ ] Docker Desktop å·²å•Ÿå‹•ä¸¦é‹è¡Œ
- [ ] ç«¯å£ 3000, 5433, 6379 æœªè¢«å ç”¨
- [ ] `.env` æ–‡ä»¶å·²æ­£ç¢ºé…ç½®
- [ ] è‡³å°‘ 4GB å¯ç”¨è¨˜æ†¶é«”
- [ ] `/health` ç«¯é»å›æ‡‰æ­£å¸¸
- [ ] API å¹³å‡éŸ¿æ‡‰æ™‚é–“ < 200ms

## ğŸ¤ é–‹ç™¼è¦ç¯„èˆ‡æœ€ä½³å¯¦è¸

### ğŸ“ ä»£ç¢¼é¢¨æ ¼è¦ç¯„

#### TypeScript ç·¨ç¢¼æ¨™æº–
```typescript
// âœ… æ¨è–¦çš„ä»£ç¢¼é¢¨æ ¼
export class ProductService {
  constructor(
    private readonly prisma: PrismaService,
    private readonly logger: Logger
  ) {}

  async createProduct(dto: CreateProductDto): Promise<ProductResponseDto> {
    this.logger.log(`Creating product: ${dto.name}`);
    
    try {
      const product = await this.prisma.product.create({
        data: {
          name: dto.name,
          description: dto.description,
          sellerId: dto.sellerId,
          categoryId: dto.categoryId,
          status: ProductStatus.ON_SHELF
        },
        include: {
          seller: { select: { username: true, shopName: true } },
          category: { select: { name: true } },
          variants: true,
          images: true
        }
      });

      return this.transformToResponseDto(product);
    } catch (error) {
      this.logger.error(`Failed to create product: ${error.message}`, error.stack);
      throw new BadRequestException('å•†å“å‰µå»ºå¤±æ•—');
    }
  }
}
```

#### å‘½åè¦ç¯„
| é¡å‹ | å‘½åè¦å‰‡ | ç¯„ä¾‹ |
|------|----------|------|
| **é¡åˆ¥** | PascalCase | `ProductService`, `UserController` |
| **æ–¹æ³•** | camelCase | `createProduct()`, `getUserById()` |
| **è®Šæ•¸** | camelCase | `productId`, `userEmail` |
| **å¸¸æ•¸** | UPPER_SNAKE_CASE | `JWT_SECRET`, `DEFAULT_PAGE_SIZE` |
| **DTO** | PascalCase + å¾Œç¶´ | `CreateProductDto`, `ProductResponseDto` |

#### âœ¨ æ–°åŠŸèƒ½
- **ğŸ” å®Œæ•´èªè­‰ç³»çµ±**: JWT é›™ Token æ©Ÿåˆ¶ã€å¯†ç¢¼é‡è¨­ã€å¤šè§’è‰²æ¬Šé™
- **ğŸ›ï¸ é›»å•†æ ¸å¿ƒåŠŸèƒ½**: å•†å“ç®¡ç†ã€è³¼ç‰©è»Šã€è¨‚å–®æµç¨‹ã€åº«å­˜æ§åˆ¶
- **ğŸ¨ å•†å“è®Šé«”ç³»çµ±**: æ”¯æ´é¡è‰²ã€å°ºå¯¸ç­‰å¤šå±¬æ€§çµ„åˆç®¡ç†
- **â­ è©•åƒ¹ç³»çµ±**: å•†å“è©•åˆ†ã€è©•è«–ç®¡ç†ã€è»Ÿåˆªé™¤æ©Ÿåˆ¶
- **ğŸ’¬ å³æ™‚èŠå¤©**: WebSocket å¯¦ç¾è²·è³£å®¶å³æ™‚æºé€š
- **ğŸ–¼ï¸ åœ–ç‰‡ç®¡ç†**: å¤šåœ–ç‰‡ä¸Šå‚³ã€å­˜å„²ã€CDN åˆ†ç™¼
- **ğŸ”§ ç®¡ç†å“¡å¾Œå°**: ç”¨æˆ¶ç®¡ç†ã€å•†å“å¯©æ ¸ã€ç³»çµ±ç›£æ§
- **ğŸ§ª API æ¸¬è©¦å¹³å°**: å…§å»º Web ç•Œé¢ï¼Œå®Œæ•´åŠŸèƒ½æ¸¬è©¦
- **ğŸ³ Docker å®¹å™¨åŒ–**: ä¸€éµéƒ¨ç½²ï¼ŒåŒ…å« PostgreSQLã€Redisã€Nginx

#### ğŸ—ï¸ æŠ€è¡“ç‰¹è‰²
- **ä¸‰å±¤å¼æ¶æ§‹**: Presentationã€Businessã€Data å±¤åˆ†é›¢
- **ä¼æ¥­ç´šå®‰å…¨**: OWASP æ¨™æº–ã€GDPR åˆè¦ã€å®Œæ•´å¯©è¨ˆæ—¥èªŒ
- **é«˜æ•ˆèƒ½è¨­è¨ˆ**: æŸ¥è©¢å„ªåŒ–ã€Redis å¿«å–ã€é€£æ¥æ± ç®¡ç†
- **å®Œæ•´æ¸¬è©¦**: 85%+ è¦†è“‹ç‡ã€E2E æ¸¬è©¦ã€æ•ˆèƒ½æ¸¬è©¦
- **ç›£æ§å‘Šè­¦**: å¥åº·æª¢æŸ¥ã€æŒ‡æ¨™ç›£æ§ã€ç•°å¸¸å‘Šè­¦

## ğŸ“ æŠ€è¡“æ”¯æ´èˆ‡ç¤¾ç¾¤

### ğŸ“‹ æˆæ¬Šè³‡è¨Š

æœ¬å°ˆæ¡ˆæ¡ç”¨ **MIT æˆæ¬Šæ¢æ¬¾**ï¼Œå…è¨±è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†ç™¼ã€‚

---

<div align="center">

### ğŸ¯ Made with â¤ï¸ by Zipperoo Team

**â­ å¦‚æœé€™å€‹å°ˆæ¡ˆå°æ‚¨æœ‰å¹«åŠ©ï¼Œè«‹çµ¦æˆ‘å€‘ä¸€å€‹ Starï¼**

[![GitHub stars](https://img.shields.io/github/stars/Damian-Hsu/Mobile_Commerce_Final_Projec_Zipperoo?style=social)](https://github.com/Damian-Hsu/Mobile_Commerce_Final_Projec_Zipperoo/stargazers)
[![GitHub forks](https://img.shields.io/github/forks/Damian-Hsu/Mobile_Commerce_Final_Projec_Zipperoo?style=social)](https://github.com/Damian-Hsu/Mobile_Commerce_Final_Projec_Zipperoo/network/members)
[![GitHub issues](https://img.shields.io/github/issues/Damian-Hsu/Mobile_Commerce_Final_Projec_Zipperoo)](https://github.com/Damian-Hsu/Mobile_Commerce_Final_Projec_Zipperoo/issues)
[![GitHub license](https://img.shields.io/github/license/Damian-Hsu/Mobile_Commerce_Final_Projec_Zipperoo)](https://github.com/Damian-Hsu/Mobile_Commerce_Final_Projec_Zipperoo/blob/main/LICENSE)


</div>